/*
 2012 ReadSpeaker International B.v.

 @class ReadSpeaker.ui
 @namespace ReadSpeaker.ui
 @memberOf ReadSpeaker
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
 2012 ReadSpeaker International B.v.
*/
ReadSpeaker.Common.Settings=function(){var a={form:{key:"data-rsform-key",prev:"data-rsform-prev",valyes:"data-rsform-trueval",valno:"data-rsform-falseval"}},b={},g=function(n){return rspkr.Common.cookie.readKey(rspkr.pub.Config.item("general.cookieName"),n)||rspkr.pub.Config.item("settings."+n)},k=function(n,a){var b=g(n);if(a!=b){var f=rspkr.c.cookie.updateKey(rspkr.cfg.item("general.cookieName"),n,a);rspkr.cfg.item("settings."+n,a);rspkr.devt("onSettingsChanged",window,[n,a,b]);return f}return null},
m={controls:{xp:function(a){return rspkr.st.r().expandPhrase(a)},helpButton:'<img src="'+rspkr.baseUrl+'img/help.png" alt="" border="0" />',select:function(n,l,b,f){var c=[],h="hl"!==n?!1:rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang);c.push('<label for="',f,'">',this.xp(l.phrase),"</label>");c.push('<select id="',f,'" name="',f,'" ',a.form.prev,'="',b,'" ',a.form.key,'="',n,'">');for(var g=0,k=l.options.length;g<k;g++)if("hl"!==n||!h||/\bsent|none/i.test(l.options[g].value))"hl"===
n&&h&&"sent"===l.options[g].value&&"none"!==b&&(b="sent"),c.push('<option value="',l.options[g].value,'"',b==l.options[g].value?' selected="selected"':"",l.options[g].dims?' data-rsform-dims="'+l.options[g].dims.join(",")+'"':"",l.options[g].hides?' data-rsform-hides="'+l.options[g].hides.join(",")+'"':"",">",this.xp(l.options[g].phrase),"</option>");c.push("</select>");l.info&&(c.push('<button type="button" id="rstoggle_',f,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',
this.xp("ph_help"),": ",this.xp(l.phrase),'">'+this.helpButton+"</button>"),c.push("&rlm;"),c.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(l.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.select,context:rspkr.st.r().handlers,params:[f]});return c.join("")},checkbox:function(n,l,b,f){var c=b==l.options.truevalue;rspkr.evt("onSettingsLoaded",
{func:rspkr.st.r().handlers.checkbox,context:rspkr.st.r().handlers,params:[f]});return['<label for="'+f+'">',this.xp(l.phrase),'</label><input type="checkbox" id="',f,'" name="',f,'"',c?' checked="checked"':"",a.form.valyes,'="',l.options.truevalue,'" ',a.form.valno,'="',l.options.falsevalue,'" ',a.form.prev,'="',b,'" ',a.form.key,'="',n,'" />'].join("")},radio:function(n,l,b,f){var c=[];c.push('<fieldset class="rsform-radio-label" aria-level="2">');c.push("<legend>",this.xp(l.phrase));l.info&&(c.push('<button id="rstoggle_',
f,'" type="button" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',this.xp("ph_help"),": ",this.xp(l.phrase),'">'+this.helpButton+"</button>"),c.push("&rlm;"));c.push("</legend>");for(var h=0,g=l.options.length;h<g;h++)c.push('<input type="radio" id="',f,"_",h,'" name="',f,'" title="',this.xp(l.phrase),": ",this.xp(l.options[h].phrase),'" value="',l.options[h].value,'"'),c.push(" ",a.form.prev,'="',b,'" ',a.form.key,'="',n,'"'),c.push(b==l.options[h].value?' checked="checked"':
""),l.options[h].dims&&c.push(' data-rsform-dims="',l.options[h].dims.join(","),'"'),c.push(" />"),c.push("&lrm;"),c.push('<label for="',f,"_",h,'">',this.xp(l.options[h].phrase),"</label>");l.info&&(c.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(l.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));c.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.radio,
context:rspkr.st.r().handlers,params:[f,h]});return c.join("")},info:function(a,l){return['<div class="rsform-infotext">',this.xp(l.phrase),"</div>"].join("")},slider_h:function(n,l,e,f){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.slider_h,context:rspkr.st.r().handlers,params:[l,f,e]});b[f]=l;return['<span class="rsform-slider-label">',this.xp(l.phrase),'</span><div id="',f,'" class="rsform-slider rsimg" ',a.form.key,'="',n,'" ',a.form.prev,'="',e,'"></div>'].join("")},colorpicker:function(n,
l,b,f){var c=[];c.push('<fieldset class="rsform-colorlist-label" aria-level="2">');c.push("<legend>",this.xp(l.phrase));l.info&&(c.push('<button type="button" id="rstoggle_',f,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',this.xp("ph_help"),": ",this.xp(l.phrase),'">'+this.helpButton+"</button>"),c.push("&rlm;"));c.push("</legend>");c.push('<ul id="',f,'" class="rsform-colorlist" ',a.form.prev,'="',b,'" ',a.form.key,'="',n,'">');n=0;for(var h=l.options.length;n<h;n++){c.push("<li",
b==l.options[n].value?' class="rsform-colorlist-active"':"",">");c.push('<a href="javascript: void(0);"');c.push(b==l.options[n].value?' tabIndex="0"':' tabIndex="-1"');c.push(' title="'+this.xp(l.phrase)+": "+this.xp(l.options[n].phrase)+'"');c.push(' data-rsform-value="',l.options[n].value,'"');if("underline"==l.options[n].value||"none"==l.options[n].value)c.push(' class="'),"underline"==l.options[n].value&&c.push("rsform-colorlist-style-underline "),"none"==l.options[n].value&&c.push("rsform-colorlist-style-none "),
c.push('"');c.push(' role="button"');c.push('><span class="rsform-colorlist-box"');"#"==l.options[n].value.substr(0,1)&&c.push(' style="background: ',l.options[n].value,';"');c.push("></span>");c.push('<span class="rsform-colorlist-label');"underline"==l.options[n].value?c.push('" style="text-decoration: underline;'):/#/.test(l.options[n].value)&&c.push(" rsform-colorlist-style-color");c.push('">',this.xp(l.options[n].phrase),"</span></a>");c.push("</li>")}c.push("</ul>");c.push('<div style="clear: both;"></div>');
l.info&&(c.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(l.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));c.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.colorpicker,context:rspkr.st.r().handlers,params:[f]});return c.join("")},restore:function(a,l,b,f){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.restore,context:rspkr.st.r().handlers,
params:[f]});return["<div>",this.xp(l.phrase),'</div><input type="button" id="',f,'" value="',this.xp("ph_"+a),'" class="rsform-button" role="button"></input>'].join("")}},handlers:{info:function(a){$rs.regEvent($rs.get("#rstoggle_"+a),"click",this.changed.info)},select:function(a){$rs.regEvent($rs.get("#"+a),"change",this.changed.select)},checkbox:function(a){$rs.regEvent($rs.get("#"+a),"click",this.changed.checkbox)},radio:function(a,l){for(var b=0;b<l;b++)$rs.regEvent($rs.get("#"+a+"_"+b),"click",
this.changed.radio)},slider_h:function(a,l,b){var f=new ReadSpeaker.ui.Slider,c={};if(a.options)for(var h in a.options)a.options.hasOwnProperty(h)&&(c[h]=rspkr.st.r().expandPhrase(a.options[h]));c.initval=a.converter?a.converter(b):b||0;c.start=function(){};c.drop=this.changed.slider_h;f.init($rs.get("#"+l),c)},colorpicker:function(a){$rs.regEvent("#"+a+" li a","keydown",function(a){var n=$rs.closest(this,"li"),b;37==a.keyCode?b=n.previousSibling:39==a.keyCode&&(b=n.nextSibling);b&&(a=$rs.findIn(b,
"a"),a.focus(),a.click());return!0});$rs.regEvent("#"+a+" li a","click",this.changed.colorpicker);$rs.css($rs.get("#"+a),"display","block")},restore:function(a){$rs.regEvent("#"+a,"click",function(){if(rs.cfg.defaultsettings){for(var a in rs.cfg.defaultsettings)if(rs.cfg.defaultsettings.hasOwnProperty(a)){var n=rs.cfg.defaultsettings[a];rspkr.st.r().handlers.updateSetting(a,n);var b=$rs.get("input[value='"+n+"']");if($rs.isArray(b))if(b=$rs.get("select[data-rsform-key='"+a+"']"),$rs.isArray(b)){if(b=
$rs.get("ul[data-rsform-key='"+a+"']"),!$rs.isArray(b)){var c=$rs.findIn(b,".rsform-colorlist-active");$rs.removeClass(c,"rsform-colorlist-active");n=$rs.findIn(b,"a[data-rsform-value='"+n+"']").parentNode;$rs.addClass(n,"rsform-colorlist-active")}}else b.value=n;else b.checked=!0}rspkr.Common.Settings.r().handlers.changed.afterdim()}})},changed:{dimmed:[],hidden:[],disable:function(a,l){l=l||"dimmed";var b=$rs.findIn(a,"input, select, textarea, ul.rsform-colorlist");$rs.addClass(a,l);if("dimmed"==
l)for(var f=0,c=b.length;f<c;f++)"ul"!=b[f].tagName.toLowerCase()&&(b[f].disabled=!0)},enable:function(a,l){l=l||"dimmed";var b=$rs.findIn(a,"input, select, textarea");$rs.removeClass(a,l);if("dimmed"==l)for(var f=0,c=b.length;f<c;f++)b[f].disabled=!1},add:function(a,l,b,f){a[l]||(a[l]=[]);for(var c=0,h=b.length;c<h;c++)this.disable($rs.get("#rscontrol_"+b[c]),f),a[l].push($rs.get("#rscontrol_"+b[c]))},release:function(a,l,b){if(a[l]){for(var f=0,c=a[l].length;f<c;f++)this.enable(a[l][f],b);a[l]=
[]}},dim:function(a,l){this.undim(a);this.add(this.dimmed,a,$rs.isArray(l)?l:[l],"dimmed")},undim:function(a){this.release(this.dimmed,a,"dimmed")},afterdim:function(){for(var a=$rs.get("#rslightbox_content .rsform-row"),l,b=0,f=a.length;b<f;b++)l=$rs.getAttr(a[b],"data-rsform-type"),l=this.dimmees[l]?this.dimmees[l](a[b]):null,"string"==typeof l?this.dim(a[b].id.replace("rscontrol_",""),l.split(",")):1===l&&this.undim(a[b].id.replace("rscontrol_",""))},addButtonEvents:function(a){$rs.regEvent($rs.get("#rslightbox_buttons .rssettings-button-close"),
"click",a.hide)},dimmees:{radio:function(a){a=$rs.findIn(a,'input[type="radio"]');for(var l,b=!1,f=0,c=a.length;f<c;f++)if(a[f].checked){l=a[f];break}l&&(b=$rs.getAttr(l,"data-rsform-dims")||1);return b},select:function(a){a=$rs.findIn(a,"option");for(var l,b=!1,f=0,c=a.length;f<c;f++)if(a[f].selected){l=a[f];break}l&&(b=$rs.getAttr(l,"data-rsform-dims")||1);return b}},info:function(a){$rs.hasClass(a.target.parentNode,"dimmed")||$rs.hasClass(a.target.parentNode.parentNode,"dimmed")||(a=$rs.get("#"+
$rs.getAttr(this,"data-rsform-toggles")),$rs.css(a,"display","none"==$rs.css(a,"display")?"block":"none"));return!1},select:function(n){this.value!==$rs.getAttr(this,a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]);return!0},checkbox:function(n){n=this.checked?$rs.getAttr(this,a.form.valyes):$rs.getAttr(this,a.form.valno);n!==$rs.getAttr(this,a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,
a.form.key),n,this]);return!0},radio:function(n){this.value!==$rs.getAttr(this,a.form.prev)&&(rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]),$rs.setAttr($rs.findIn(this.parentNode,'input[name="'+this.name+'"]'),a.form.prev,this.value));return!0},slider_h:function(n,l){var e=l.parent,f=b[l.rsid],f=f.converter?f.converter(parseInt(n)):parseInt(n),c=$rs.getAttr(e,a.form.prev);f!==c&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,
[$rs.getAttr(e,a.form.key),f,e])},colorpicker:function(n){n.originalEvent&&n.originalEvent.preventDefault&&n.originalEvent.preventDefault();var b=n.target.parentNode.parentNode,e=n.target.parentNode;if(!$rs.hasClass(n.target.parentNode.parentNode.parentNode,"dimmed")&&$rs.getAttr(n.target,"data-rsform-value")!==$rs.getAttr(b,a.form.prev)){$rs.removeClass($rs.findIn(b,"li"),"rsform-colorlist-active");rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(b,a.form.key),$rs.getAttr(n.target,
"data-rsform-value"),b]);$rs.addClass(e,"rsform-colorlist-active");for(var b=$rs.findIn(b,"a"),e=0,f;f=b[e];e++)$rs.setAttr(f,"tabIndex","-1");$rs.setAttr(n.target,"tabIndex",0)}}},updateSetting:function(n,b,e){rspkr.log("[rspkr.st] Setting updated: "+n+" | New value: "+b);k(n,b);if(e){n=$rs.closest(e,".rsform-row");var f=$rs.css(n,"background-color");rspkr.u.hl(n,function(){$rs.css(this,"background-color",f)});$rs.setAttr($rs.get(e),a.form.prev,b)}}},expandPhrase:function(a){if("string"==typeof a&&
"ph_"==a.substr(0,3)){a=a.substr(3);var b=rspkr.cfg.getPhrase(a);return void 0!==b?b:a}return a},row:function(a,b,e){if(/hlword|hltoggle/i.test(a)&&rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang))return"";var f=rspkr.cfg.item("ui.settings.formrow").join("\n"),c={},h=ReadSpeaker.getID();e=this.controls[b.type](a,b,e,h);c.rsCONTROL_IDrs=a;c.rsCONTROLrs=e;c.rsCONTROL_TYPErs=b.type;c.rsCONTROL_CLASSESrs=b.classes?b.classes.join(" "):"";return this.replaceTokens(f,c)},group:function(a){var b=
rspkr.cfg.item("ui.settings.formsection").join("\n"),e={},f=[],c;for(c in a.items)a.items.hasOwnProperty(c)&&f.push(this.row(c,a.items[c],g(c)));e.rsSECTION_IDrs=ReadSpeaker.getID();e.rsSECTION_HEADINGrs=this.controls.xp(a.phrase);e.rsSECTION_ROWSrs=f.join("\n");return this.replaceTokens(b,e)},replaceTokens:function(a,b){var e=a,f;for(f in b)b.hasOwnProperty(f)&&(e=e.replace(new RegExp(f,"igm"),b[f]));return e}};return{meta:{revision:"4629"},r:function(){return m},e:a,init:function(){for(var a=["ReadSpeakerHL",
"ReadSpeakerHLicon","ReadSpeakerHLspeed"],b=!1,e=0,f=a.length;e<f;e++){var c=rspkr.Common.cookie.read(a[e]);c&&(rspkr.Common.cookie.updateKey(rspkr.pub.Config.item("general.cookieName"),a[e].substr(11).toLowerCase(),c),b=!0,rspkr.Common.cookie.erase(a[e]))}b&&rspkr.log("[rspkr.st] Transferred legacy cookie.");rspkr.Common.dispatchEvent("onSettingsInitialized");rspkr.log("[rspkr.st] Initialized!");rspkr.Common.addEvent("onSettingsLoaded",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,
params:[]});rspkr.Common.addEvent("onSettingsChanged",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]})},get:function(a){return g(a)},getAll:function(){return rspkr.Common.cookie.readKeyAll(rspkr.pub.Config.item("general.cookieName"))},set:function(a,b){return k(a,b)},getHTML:function(){var a=rspkr.cfg,b=[],e=a.item("ui.settings.form").join("\n"),f={},c=a.getSettingsConf(),h;for(h in c)c.hasOwnProperty(h)&&b.push(m.group(c[h]));
c="";rspkr.ui.getActivePlayer()&&rspkr.cfg.item("ui.listenBtn")&&(c=document.createElement("div"),c.innerHTML=a.item("ui.listenBtn").join(""),a=rspkr.ui.getActivePlayer().getHref(),a=a.replace(/readid=[^&]+/gi,"readid=rslightbox_content"),a=a.replace(/&url=[^&]+/gi,""),$rs.setAttr($rs.findIn(c,".rsbtn_play"),"href",a),c=m.replaceTokens(c.innerHTML,{rsLISTENrs:m.controls.xp("ph_listen")}));f.rsSETTINGS_HEADINGrs=m.controls.xp("ph_settings");f.rsLISTEN_BUTTONrs=rs.cfg.item("ui.settingsListenButton")&&
"rsbtn"===rs.ui.rsbtnClass?c:"";f.rsSECTIONS_STARTrs="";f.rsSECTIONSrs=b.join("");f.rsSECTIONS_ENDrs="";return m.replaceTokens(e,f)},getButtons:function(){var a=rspkr.cfg.item("ui.settings.formbuttons").join("\n"),b={};b.rsSETTINGS_BUTTON_CLOSErs=m.controls.xp("ph_close");return m.replaceTokens(a,b)}}}();
ReadSpeaker.PlayerAPI=function(){var a={audioFormat:"flv",minver:8,check:function(){return rspkr.c.data.browser.flashVersion.split(",").shift()>=this.minver?!0:!1}},b={prioritize:!1,audioFormat:null,check:function(){return rspkr.c.data.browser.html5Support?(this.audioFormat=rspkr.c.data.browser.html5AudioFormat,this.prioritize=rspkr.c.data.browser.html5Priority,!0):!1}},g="",k=function(a,b){for(var e in b)a[e]=b[e]},m={meta:{revision:"DEV"},init:function(){rspkr.log("[rspkr.pl] Initialized!");rspkr.Common.addEvent("onModsLoaded",
function(){rspkr.Common.Detect.init();rspkr.PlayerAPI.setAdapter()})},setAdapter:function(){g=b.check()&&a.check()?b.prioritize?"html5":"flash":b.check()?"html5":a.check()?"flash":"fallback";"html5"==g?(rspkr.log("[rspkr.pl] Using adapter "+g,1),k(m,rspkr.pl.html5.adapter)):"flash"==g?(rspkr.log("[rspkr.pl] Using adapter "+g,1),k(m,rspkr.pl.flash.adapter)):(rspkr.log("[rspkr.pl] No adapter detected - using fallback!",3),k(m,rspkr.pl.fallback.adapter))},getProduct:function(){return ReadSpeaker.HL?
ReadSpeaker.HL:ReadSpeaker.XP?ReadSpeaker.XP:!1}};return m}();
ReadSpeaker.PlayerAPI.flash=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.flash heartbeat!")},adapter:{adapter:"flash",playerRef:null,timerCallBack:null,timerContext:null,loadTimer:null,progressStarted:!1,networkCheckCounter:0,play:function(){if(this.playerRef)try{this.playerRef.rs_player_play(),rspkr.devt("onAPIPlay",window)}catch(a){ReadSpeaker.log("error: "+a)}else this.initAdapter()},pause:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_pause(),rspkr.devt("onAPIPause",
window)}catch(a){rspkr.log("error: "+a,3)}},stop:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){rspkr.log("error: "+a,3)}},volUp:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_volup(),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_voldown(),rspkr.devt("onAPIVolumeDown",window))},mute:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_mute(),rspkr.devt("onAPIMute",window))},
forward:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpff(),rspkr.devt("onAPIFastForward",window))},rewind:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpbb(),rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume]",4);rspkr.pl.playerRef&&(this.playerRef.setVolume?(this.playerRef.setVolume(a),rspkr.devt("onAPISetVolume",window)):window.setTimeout(function(){rspkr.pl.setVolume(a)},10))},setProgress:function(a){if(rspkr.pl.playerRef)try{this.playerRef.setProgress(a),
rspkr.devt("onAPISetProgress",window)}catch(b){}},getProgress:function(a,b,g){rspkr.pl.playerRef&&(this.timerCallBack=b,this.timerContext=g||b,rspkr.pl.playerRef&&"function"==typeof rspkr.pl.playerRef.getProgress?(clearTimeout(this.loadTimer),rspkr.pl.playerRef.getProgress(a,"rspkr.pl.timer",500),this.progressStarted=!0):this.progressStarted||(this.loadTimer=window.setTimeout(function(){rspkr.pl.getProgress(a,b,g)},500)),rspkr.devt("onAPIGetProgress",window))},timer:function(a){a=a.split("|");if("function"==
typeof this.timerCallBack)try{this.timerCallBack.apply(this.timerContext,[a])}catch(b){}},checkNetworkStatus:function(){3<rspkr.pl.networkCheckCounter||setTimeout(function(){if(rspkr.pl.playerRef){rspkr.pl.networkCheckCounter++;try{rspkr.log("[rspkr.pl.checkNetworkStatus] "+rspkr.pl.playerRef.rs_player_networkStatus(),1)}catch(a){rs.pl.checkNetworkStatus();return}3===rspkr.pl.playerRef.rs_player_networkStatus()?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",
window)):0===rs.PlayerAPI.playerRef.rs_player_networkStatus()&&rs.pl.checkNetworkStatus()}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){var a=encodeURIComponent(rspkr.c.data.getAudioLink({audioformat:"flv"}));this.progressStarted=!1;this.releaseAdapter();var b=document.getElementById("rs_player_holder");b||(b=document.createElement("div"),$rs.setAttr(b,"id","rs_player_holder"),document.body.appendChild(b));a=['<object id="readspeaker_flash_player" '+(document.selection?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"':
'type="application/x-shockwave-flash" data="'+ReadSpeaker.pub.Config.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" ')+'style="height: 1px; width: 1px;">','<param name="movie" value="'+rspkr.cfg.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" />','<param name="quality" value="high" />','<param name="autostart" value="true" />','<param name="allowScriptAccess" value="'+rspkr.cfg.item("flash.allowScriptAccess")+'" />','<param name="loop" value="false" /></object>'];b.innerHTML=a.join("\n");$rs.setAttr(b,
"style","position: fixed; bottom: 0px; right: 0px;");var g=function(a){4===a&&rspkr.pl.playerRef&&rspkr.pl.playerRef.setVolume&&(rspkr.pl.playerRef.setVolume(rspkr.st.get("hlvol")||"100"),document.attachEvent?$rs.get("#readspeaker_flash_player").detachEvent("onreadystatechange",g):document.addEventListener&&$rs.get("#readspeaker_flash_player").removeEventListener("load",function(){g(4)},!1))};document.attachEvent?($rs.get("#readspeaker_flash_player").attachEvent("onreadystatechange",g),rspkr.devt("onVolumeAdjusted",
window)):document.addEventListener&&$rs.get("#readspeaker_flash_player").addEventListener("load",function(){g(4)},!1);rspkr.pl.playerRef=document.getElementById("readspeaker_flash_player");rspkr.devt("onAPIInitAdapter",window);rspkr.pl.checkNetworkStatus()},releaseAdapter:function(){if(rspkr.pl.playerRef){try{rspkr.pl.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){ReadSpeaker.log("error: "+a)}var b=$rs.get("#rs_player_holder");b.removeChild(rspkr.pl.playerRef);document.body.removeChild(b);
rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();
ReadSpeaker.PlayerAPI.html5=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.html5 heartbeat!")},adapter:{adapter:"html5",playerRef:null,timerCallBack:null,timerContext:null,bufferedTime:null,play:function(){ReadSpeaker.log("[rspkr.pl.play]");rspkr.HL.chunking&&rspkr.HL.chunking.close();rspkr.HL.chunking&&rspkr.HL.chunking.chunkEnded?(rspkr.HL.chunking.chunkEnded=!1,rspkr.c.dispatchEvent("onChunkResume",window)):!this.playerRef||rspkr.HL.newPlayback?(this.initAdapter(),rspkr.HL.newPlayback=
!1):(rspkr.pl.playPromise(this.playerRef),rspkr.devt("onAPIPlay",window))},playPromise:function(a,b,g){a=a.play();if(void 0!==a)a.then(function(){b&&"function"===typeof b&&b.call()})["catch"](function(a){g&&"function"===typeof g&&g.call(a)});else"function"===typeof b&&b.call()},pause:function(){this.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=
0),rspkr.devt("onAPIStop",window))},volUp:function(){this.playerRef&&(this.playerRef.volume=Math.min(1,this.playerRef.volume+.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){this.playerRef&&(this.playerRef.volume=Math.max(0,this.playerRef.volume-.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeDown",window))},mute:function(){this.playerRef&&(this.playerRef.volume=0,rspkr.devt("onAPIMute",window))},forward:function(){this.playerRef&&
(this.playerRef.currentTime=this.playerRef.currentTime+5<this.playerRef.duration?this.playerRef.currentTime+5:this.playerRef.duration,rspkr.devt("onAPIFastForward",window))},rewind:function(){this.playerRef&&(this.playerRef.currentTime=0<this.playerRef.currentTime-5?this.playerRef.currentTime-5:0,rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume] "+a,4);this.playerRef&&(this.playerRef.volume=parseFloat(a/100),rspkr.devt("onAPISetVolume",window))},setProgress:function(a){if(this.playerRef){a=
parseInt(a);var b=parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());this.playerRef.currentTime=a<b&&a<this.playerRef.duration?a:this.playerRef.duration;rspkr.HL&&rspkr.HL.html5&&rspkr.HL.html5.lastcurrenttime&&(rspkr.HL.html5.lastcurrenttime=0);rspkr.devt("onAPISetProgress",window)}},getProgress:function(a,b,g){this.playerRef&&(0==a?rspkr.pl.playerRef.removeEventListener("timeupdate",rspkr.pl.timer,!1):(this.timerCallBack=b,this.timerContext=g||b,rspkr.pl.playerRef.addEventListener("timeupdate",
rspkr.pl.timer,!1),rspkr.devt("onAPIGetProgress",window)))},timer:function(){if(rspkr.pl.playerRef){var a=1E3*parseInt(rspkr.pl.playerRef.currentTime);rspkr.pl.bufferedTime=1E3*parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());var b=[a,rspkr.pl.bufferedTime];if(rspkr.hl.html5&&rspkr.hl.html5.synclist&&rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1]){var g=rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1][0];rspkr.pl.bufferedTime>g&&(b=[a,g])}if("function"==
typeof rspkr.pl.timerCallBack)try{rspkr.pl.timerCallBack.apply(rspkr.pl.timerContext,[b])}catch(k){rspkr.log("timeupdate error",2)}}},checkNetworkStatus:function(){var a=rs.pl.playerRef;rs.pl.errorCount=rs.pl.errorCount||0;rs.pl.networkStates=rs.pl.networkStates||[0,0,0,0];setTimeout(function(){if(a){rs.pl.networkStates[a.networkState]++;rs.pl.networkStates[4]=a.buffered&&a.buffered.length&&0<a.buffered.end(0)?a.buffered.end(0):!1;rs.pl.networkStates[5]=a.duration&&a.duration&&!isNaN(a.duration)&&
0<a.duration?a.duration:!1;if(3===a.networkState)rs.pl.errorCount++,10<rs.pl.errorCount&&!rs.pl.networkStates[4]&&!rs.pl.networkStates[5]?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",window)):rspkr.pl.checkNetworkStatus();else if(2===a.networkState){rs.pl.errorCount=0;var b=0<a.buffered.length?a.buffered.end(a.buffered.length-1):0,g=a.duration||0;(0==g||b<g)&&rspkr.pl.checkNetworkStatus()}else rs.pl.errorCount=0;rspkr.log(rs.pl.networkStates,
5)}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){rspkr.devt("onAPIInitAdapter",window)},releaseAdapter:function(){if(rspkr.pl.playerRef){rspkr.pl.playerRef.pause();try{0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0)}catch(a){}rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.releaseAdapter();this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();
rspkr.PlayerAPI.fallback=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.fallback heartbeat!")},adapter:{adapter:"fallback"}}}();
rspkr.HL=function(){var a="",b={firstRun:0,previousWord:{},previousSent:{},lastWord:null,selectionRange:null,selectionHTML:null,selectedWordsRange:[]},g={oldWordHL:[],oldWordHLClass:[],oldSentHL:[],oldSentHLClass:[],sync:function(a,b){var e=!1,f=document.getElementById("sync"+b);0==(a&2)&&(e=0!=(a&1)?!0:!1);if(f&&f.className.replace("word","")!=f.className){if(!e&&0<this.oldWordHL.length){for(e=0;e<this.oldWordHLClass.length;e++)this.oldWordHL[e].className=this.oldWordHLClass[e];this.oldWordHL=[];
this.oldWordHLClass=[]}this.oldWordHLClass.push(f.className);this.oldWordHL.push(f);rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(f,a);f.className=f.className.replace("sync_word","sync_word_highlighted")}else if(f&&f.className.replace("sent","")!=f.className){if(!e&&0<this.oldSentHL.length){for(e=0;e<this.oldSentHL.length;e++)this.oldSentHL[e].className=this.oldSentHLClass[e];this.oldSentHL=[];this.oldSentHLClass=[]}this.oldSentHLClass.push(f.className);this.oldSentHL.push(f);
rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.sentHL(f,a);f.className=f.className.replace("sync_sent","sync_sent_highlighted")}f&&rspkr.HL.Scroll.execScroll(f)},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");var a=rspkr.Common.data.getParam("readid"),a=document.getElementById(a).innerHTML;rspkr.Common.data.setRestoreContent(a)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!");
rspkr.HL.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");var a=rspkr.HL.serverMarkup.oldWordHL,b=rspkr.HL.serverMarkup.oldWordHLClass,e=rspkr.HL.serverMarkup.oldSentHL,f=rspkr.HL.serverMarkup.oldSentHLClass;if(a&&0<a.length){for(var c=0;c<a.length;c++)a[c].className=b[c];rspkr.HL.serverMarkup.oldWordHL=[];rspkr.HL.serverMarkup.oldWordHLClass=[]}if(e&&0<e.length){for(c=0;c<e.length;c++)e[c].className=f[c];rspkr.HL.serverMarkup.oldSentHL=[];rspkr.HL.serverMarkup.oldSentHLClass=
[]}c=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1");a=$rs.get(c+".sync_sent,"+c+".sync_word,"+c+".sync_sent_highlighted,"+c+".sync_word_highlighted,"+c+".sync_user,"+c+".synctemp,"+c+'[class*="ffsent"]');a=$rs.isArray(a)?a:[a];for(c=a.length-1;-1<c;c--)a[c].className=a[c].className.replace("sync_sent_highlighted","sync_sent"),a[c].className=a[c].className.replace("sync_word_highlighted","sync_word"),-1!==a[c].className.toLowerCase().indexOf("sync_user")&&(a[c].className=
a[c].className.replace("sync_sent",""),a[c].className=a[c].className.replace("sync_word",""),a[c].removeAttribute("id"))}}},k=function(){rspkr.log("[rspkr.HL.addEvents]");var a=rspkr.Common.addEvent;a("onUIClosePlayer",rspkr.HL.sync.lightCleanUp);a("onUIClosePlayer",rspkr.HL.cleanUpHandler);a("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)});a("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)});a("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()});
rspkr.PlayerAPI&&rspkr.PlayerAPI.adapter&&"html5"===rspkr.PlayerAPI.adapter&&(rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release));rspkr.evt("onAPIStop",
rspkr.HL.sync.lightCleanUp)},m={enums:{key:"readspeaker_inline_styles",sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted"},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var a=rspkr.pub.Config,b=rspkr.Common.Settings.get("hlword")||a.item("settings.hlword"),e=rspkr.Common.Settings.get("hlsent")||a.item("settings.hlsent"),a=rspkr.Common.Settings.get("hltext")||a.item("settings.hltext");this.updateHL("hlword",b,null);this.updateHL("hlsent",
e,null);this.updateHL("hltext",a,null)},updateHL:function(n,l,e){e=e||null;"hlspeed"===n&&l!==e&&(this.hlChanged=!0);l===e||"hl"!==n&&"hltoggle"!==n||(this.hlChanged=!0,rspkr.HL.sync.lightCleanUp());l!==e&&("hl"===n&&"none"!==l||"hltoggle"===n&&"hlon"===l)&&(this.setTextStyle("word",rspkr.Common.Settings.get("hlword")),this.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),this.setTextStyle("hltext",rspkr.Common.Settings.get("hltext")),this.hlChanged=!0,rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&
rspkr.PlayerAPI.releaseAdapter());/hltext|hlword|hlsent|hlscroll/i.test(n)&&l!=e&&("hlscroll"==n?rspkr.HL.Scroll.initScroll():(this.setTextStyle(n,l),"explorer"==a&&(b.selectionRange&&"wordsent"===rspkr.st.get("hl")&&"hlsent"==n&&(b.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),b.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))),b.lastWord&&("sent"==rspkr.st.get("hl")?b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")):
b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")),b.lastWord.execCommand("forecolor",0,rspkr.Common.Settings.get("settings.hltext"))))))},setTextStyle:function(a,b,e){var f=/word/.test(a)?"word":"sent",c="background-color";e=e||m.enums.key;/underline/.test(b)?(c="text-decoration",b+=" !important; background-color: none !important"):/none/.test(b)?(c="background",b+=" !important; text-decoration: none !important; background-color: none !important"):"hltext"===a?(a=b,b=this.getStyleString(rspkr.Common.Settings.get("hlsent"),
a),a=this.getStyleString(rspkr.Common.Settings.get("hlword"),a),rspkr.Common.css.replaceRule(e,"."+m.enums.word_hl,c+": "+a)):b+=" !important; text-decoration: none !important; color: "+rspkr.Common.Settings.get("hltext")+" !important";rspkr.Common.css.replaceRule(e,"."+m.enums[f+"_hl"],c+": "+b)},getStyleString:function(a,b){var e=/underline|none/i.test(a)?"none":a,f=/underline/i.test(a)?"underline":"none";return e+" !important; text-decoration: "+f+" !important; color: "+b+" !important"}};return{meta:{revision:"DEV"},
init:function(){var n=rspkr.Common.addEvent;n("onAfterModsLoaded",function(){n("onAPIInitAdapter",rspkr.HL.Restore.setRestoreContent);rspkr.HL.addEvents();rspkr.HL.Scroll.initScroll();a=document.selection&&(9>rspkr.Common.data.browser.version||9>document.documentMode)?"explorer":"gecko";rspkr.log("[rspkr.hl] Using engine "+a);var l=rspkr.HL.engine[a].clientExtension,e;for(e in l)b[e]=l[e];window.addEventListener&&window.addEventListener("message",rspkr.HL.html5.receiveMessage,!1,!0)});n("onModsLoaded",
{func:m.setHL,context:m});n("onSettingsChanged",{func:m.updateHL,context:m});rspkr.HL.chunking={html5support:!!document.createElement("audio").canPlayType,close:function(){var a=$rs.get(".rsresume");$rs.isArray(a)||(a=[a]);for(var b=0,n;n=a[b];b++)n.parentElement.removeChild(n)},silence:function(){rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.src&&(rspkr.HL.chunking.entracte.pause(),rspkr.HL.chunking.entracte.currentTime&&(rspkr.HL.chunking.entracte.currentTime=0))},kill:function(){rspkr.HL.chunking.timer&&
clearTimeout(rspkr.HL.chunking.timer);rspkr.HL.chunking.continueHref=null;rspkr.HL.chunking.stall=null;rspkr.HL.chunking.chunkEnded=null;rspkr.HL.chunking.currentChunkNumber=1;rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.removeAttribute("src")},destroy:function(){rspkr.HL.chunking.silence();rspkr.HL.chunking.close();rspkr.HL.chunking.kill()}};rspkr.HL.chunking.currentChunkNumber=1;n("onChunkResume",function(){rspkr.HL.chunking.silence();var a=rspkr.ui.getActivePlayer().getContainer();if($rs.hasClass(a,
"rsautopaused")||!$rs.hasClass(a,"rspaused"))if(rspkr.HL.chunking.stall)setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},250);else{$rs.removeClass(a,"rsautopaused");clearTimeout(rspkr.HL.chunking.timer);var a=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}",rspkr.Common.data.browser.html5AudioFormat),b=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}","html5iframe");rspkr.HL.chunking.continueHref=void 0;rspkr.HL.html5.audioUrl=a.replace(/&amp;/g,"&");rspkr.HL.html5.frameUrl=
b.replace(/&amp;/g,"&");rspkr.HL.html5.initSyncFrame();rspkr.HL.html5.initAudio();rspkr.ui.getActivePlayer().play();rspkr.HL.chunking.currentChunkNumber++}});rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){k()},cleanUpHandler:function(a){rspkr.log("[rspkr.HL.cleanUpHandler] String is: "+a);"userclick"===a||"nosel"===a?rspkr.HL.sync.fullCleanUp():rspkr.HL.sync.lightCleanUp()},clientMarkup:b,serverMarkup:g,markedUpHTML:[],html5:{States:{BEGIN:0,STOPPED:1,USER_START_NOT_READY:2,USER_START_PLAYING:3,
NOT_PLAYING:4,CURRENT:0,setState:function(a){this.CURRENT=a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},Events:{canPlay:!1,durationChange:!1,syncReady:!1,eventTimer:null,onCanPlay:function(){rspkr.log("onCanPlay fired!",1);this.canPlay=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500);return!1},checkCompletion:function(){this.canPlay&&
this.durationChange&&this.syncReady&&(clearTimeout(this.eventTimer),this.eventTimer=null,rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh())},onDurationChange:function(){rspkr.log("onDurationChange fired!",1);this.durationChange=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},onSyncReady:function(){rspkr.log("onSyncReady fired!",1);this.syncReady=
!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},resetAll:function(){this.syncReady=this.durationChange=this.canPlay=!1}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,audioUrl:null,backupUrl:null,frameUrl:null,timer:null,postMessageData:[],runningRefresh:!1,handlers:{init:function(){rspkr.log("[rspkr.HL.html5.handlers.init]");
rspkr.HL.html5.cronologyCheck={proxyCallsDone:!1,errorOccured:!1,quarantine:[]};rspkr.HL.html5.rshlendCall=!1;var a=Math.random(),b={};b.audioformat=rspkr.Common.data.browser.html5AudioFormat;b.requestgrouptype="html5iframe";b.requestgroup=a;window.rshlcontinue&&"function"==typeof window.rshlcontinue&&-1!=Object.keys(rspkr.Common.e).indexOf("onChunkResume")&&(b.chunk=1);rspkr.HL.html5.backupUrl=rspkr.Common.data.getAudioLink(b);(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||
0<rspkr.Common.data.selectedHTML.length)&&"iOS"!==rspkr.Common.data.browser.OS&&"Android"!==rspkr.Common.data.browser.OS&&"Windows Phone"!==rspkr.Common.data.browser.OS?rspkr.HL.html5.timer=setTimeout(function(){rspkr.HL.html5.initSyncFrame(b);rspkr.HL.html5.initAudio();clearTimeout(rspkr.HL.html5.timer)},2E3):(rspkr.log("Normal audio init!"),rspkr.HL.html5.initSyncFrame(b),rspkr.HL.html5.initAudio())},play:function(){rspkr.log("[rspkr.HL.html5.handlers.play]");rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&
rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):
(rspkr.hl.html5.States.CURRENT=rspkr.hl.html5.States.USER_START_PLAYING,rspkr.hl.html5.refresh())},pause:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.hl.html5.lastcurrenttime=0},release:function(){rspkr.log("[rspkr.HL.html5.handlers.release]");rspkr.HL.html5.synclist=[];rspkr.HL.html5.synclistindex=0;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.audioUrl=null;rspkr.HL.html5.backupUrl=null;rspkr.HL.html5.frameUrl=null;rspkr.HL.html5.postMessageData=
[];rspkr.HL.html5.Events.resetAll();rspkr.PlayerAPI.playerRef&&rspkr.PlayerAPI.playerRef.removeEventListener("ended",rshlexit,!1);rspkr.PlayerAPI.playerRef=null;var a=document.getElementById("ReadSpeaker_sync_iframe");a&&(a.src="about:blank")},stop:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED);rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.HL.html5.handlers.updateTime]");rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);
rspkr.HL.html5.lastcurrenttime=rspkr.PlayerAPI.playerRef.currentTime;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.handlers.setCurrentSyncIndex();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.runPostMessages]");var a=rspkr.HL.html5.postMessageData,b;for(b in a)null!==a[b-1]&&"rshlsetContent"==a[b]?rspkr.HL.sync.setContent(rspkr.Common.base64.decode(a[b-1])):null!==a[b-1]&&"rshlsetId"==a[b]?rspkr.HL.sync.setId(a[b-
1]):"rshlinit"==a[b]&&(rspkr.HL.sync.init(),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef),rspkr.HL.html5.refresh())},clearPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.clearPostMessages]");rspkr.HL.html5.postMessageData=[]},setCurrentSyncIndex:function(){if(0<rspkr.HL.html5.synclist.length&&rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex])for(;rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex]&&20>=1*rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex][0]-1E3*rspkr.PlayerAPI.playerRef.currentTime;)rspkr.HL.html5.currentsyncindex++},
totalTime:function(){var a=rspkr.PlayerAPI.playerRef;if(a)if("Opera"!==rspkr.Common.data.browser.name&&a.buffered&&a.buffered.end)try{return 0<a.buffered.length?a.buffered.end(a.buffered.length-1):a.buffered.end(0)}catch(b){return a.duration&&"infinity"!==a.duration.toString().toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}else return a.duration&&"infinity"!==a.duration.toString.toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}},initAudio:function(){if(!rspkr.HL.html5.audioUrl||
rspkr.HL.newPlayback)rspkr.HL.html5.audioUrl=rspkr.HL.html5.backupUrl;rspkr.log("[rspkr.html5.initAudio] Audio URL: "+rspkr.HL.html5.audioUrl,1);/windows phone|ios|android/i.test(rspkr.c.data.browser.OS)&&"object"===typeof window.rspkr.audio&&null!==window.rspkr.audio?(rspkr.audio.src=rspkr.HL.html5.audioUrl,rspkr.PlayerAPI.playerRef=rspkr.audio,rspkr.log("[rs.hl.initAudio] Reusing existing audio element.",4)):rspkr.PlayerAPI.playerRef=new Audio(rspkr.HL.html5.audioUrl);var a=rspkr.PlayerAPI.playerRef;
a.loop=!1;a.preload="auto";a.volume=parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.devt("onVolumeAdjusted",window);/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)&&rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef,rspkr.PlayerAPI.playerRef.pause.bind(rspkr.PlayerAPI.playerRef));a.addEventListener("canplay",function(){rspkr.hl.html5.Events.onCanPlay()},!1);a.addEventListener("durationchange",function(){rspkr.log("[rspkr.hl.html5.initAudio] Durationchange occurred",1);1==rspkr.HL.html5.handlers.totalTime()&&
1==rspkr.PlayerAPI.playerRef.paused?rspkr.HL.html5.initAudio():(0===rspkr.HL.html5.handlers.totalTime()&&rspkr.pl.playPromise(rspkr.pl.playerRef),rspkr.hl.html5.Events.onDurationChange())},!1);rspkr.PlayerAPI.playerRef.addEventListener("ended",function(){rs.HL.chunking.continueHref?window.rshlcontinue():window.rshlexit("false")},!1);rspkr.pl.checkNetworkStatus();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},initSyncFrame:function(a){if("none"!=rspkr.Common.data.sync){var b=null;document.getElementById("ReadSpeaker_sync_iframe")?
b=document.getElementById("ReadSpeaker_sync_iframe"):(b=document.createElement("iframe"),b.setAttribute("id","ReadSpeaker_sync_iframe"),b.setAttribute("title","ReadSpeaker_sync_iframe"),b.setAttribute("aria-hidden","true"),b.height=0,b.width=0,b.style.display="none",document.body.appendChild(b));!rspkr.HL.html5.frameUrl&&(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)?rspkr.HL.html5.frameUrl=rspkr.HL.html5.backupUrl+"sync":
rspkr.HL.html5.frameUrl||(a.audioformat="html5iframe",rspkr.HL.html5.frameUrl=rspkr.Common.data.getAudioLink(a));rspkr.log("[rspkr.HL.html5.initSyncFrame] Audio URL: "+rspkr.HL.html5.frameUrl);rspkr.HL.html5.frameUrl&&(b.src=rspkr.HL.html5.frameUrl,b.type="text/javascript")}else rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.pl.playPromise(rspkr.pl.playerRef)},removeSyncFrame:function(){var a=document.getElementById("ReadSpeaker_sync_iframe");a&&a.parentNode.removeChild(a)},
receiveMessage:function(a){var b=!0;rspkr.cfg.item("general.servercall")&&(b=document.createElement("a"),$rs.setAttr(b,"href",rspkr.cfg.item("general.servercall")),b=!a.origin.match(b.hostname));if(a.origin.match(/readspeaker.?.com/gi)||a.origin.match(/79.136.80./gi)||a.origin.match(/173.205.5./gi)||a.origin.match(/2001:668:1F:2A/gi)||a.origin.match(/2001:9b0:2:703/gi)||a.origin.match(rspkr.cfg.item("general.domain"))||!b){if(!0===rspkr.cfg.item("general.usePost")){var e=rspkr.HL.html5.cronologyCheck;
if("rshlend"===a.data&&e.quarantine&&0<e.quarantine.length)e.errorOccured=!1,e.cleanUpTimer=setInterval(function(){if(0<e.quarantine.length){var a=e.quarantine.shift();window.postMessage(a,"*")}else clearInterval(e.cleanUpTimer)},0);else if("rshlendpost"===a.data)e.proxyCallsDone=!0;else if((!e.proxyCallsDone||e.errorOccured)&&"http"!==a.data.substring(0,4)&&"rshlaudio"!==a.data&&"rshlhtml5sync"!==a.data&&"rshlfinished"!==a.data){e.errorOccured=!0;e.quarantine.push(a.data);return}}rspkr.HL.html5.postMessageData.push(a.data);
/android|ios|windows phone/i.test(rspkr.Common.data.browser.OS)||"rshlfinished"!=a.data||(rspkr.HL.html5.timer&&clearTimeout(rspkr.HL.html5.timer),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio());if("rshlend"===a.data)rspkr.HL.html5.rshlendCall=!0,rspkr.c.post.removeIframe(),rspkr.HL.html5.removeSyncFrame();else{if(-1!=a.data.indexOf("."+rspkr.Common.data.browser.html5AudioFormat)){a=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(a.data):a.data;
rspkr.HL.html5.audioUrl=a;return}if(-1!=a.data.indexOf(".html5iframe")){a=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(a.data):a.data;rspkr.HL.html5.frameUrl=a;return}if("rshlaudio"==a.data||"rshlhtml5sync"==a.data)return;null!=rspkr.HL.html5.lastevent&&"rshlsetContent"==a.data?(rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.sync.setContent(rspkr.Common.base64.decode(rspkr.HL.html5.lastevent.data))):null!=rspkr.HL.html5.lastevent&&"rshlsetId"==
a.data?rspkr.HL.sync.setId(rspkr.HL.html5.lastevent.data):null!=rspkr.HL.html5.lastevent&&"rshlReplace"==a.data?(rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)&&(b=rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)[0].replace("class=",""),rspkr.HL.sync.setClass(b)),rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)&&(b=rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)[0].replace("id=",""),rspkr.HL.sync.setId(b))):"rshlinit"==a.data?(rspkr.HL.sync.init(),rspkr.hl.html5.Events.onSyncReady()):
null!=rspkr.HL.html5.lastlastlastevent&&null!=rspkr.HL.html5.lastlastevent&&null!=rspkr.HL.html5.lastevent&&"rshlsync"==a.data?(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastlastlastevent.data,rspkr.HL.html5.lastlastevent.data,rspkr.HL.html5.lastevent.data],rspkr.HL.html5.synclistindex++):null!=rspkr.HL.html5.lastevent&&"rshlcontinue"==a.data?(rs.HL.chunking.continueHref=rspkr.HL.html5.lastevent.data,rs.HL.chunking.continueTime=rspkr.HL.html5.lastlastevent&&!isNaN(rspkr.HL.html5.lastlastevent.data)?
rspkr.HL.html5.lastlastevent.data:-1,/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)&&(rspkr.HL.chunking.continueTime=-1)):"rshlresume"==a.data&&(rspkr.HL.html5.synclist.length=0,rspkr.HL.html5.synclistindex=0,rspkr.HL.html5.currentsynclistindex=0,rspkr.HL.html5.currentsyncindex=0)}rspkr.HL.html5.lastlastlastevent=rspkr.HL.html5.lastlastevent;rspkr.HL.html5.lastlastevent=rspkr.HL.html5.lastevent;rspkr.HL.html5.lastevent=a}},refresh:function(){var a=rspkr.PlayerAPI.playerRef,b=rspkr.HL.html5;
a&&b.States.CURRENT!=b.States.STOPPED?(b.States.CURRENT==b.States.NOT_PLAYING&&setTimeout(function(){b.refresh()},500),0<a.currentTime&&parseInt(b.lastcurrenttime)>parseInt(Math.ceil(a.currentTime))?(rspkr.log("[rspkr.hl.html5.refresh] An error has occurred. Player is stopped.",2),rspkr.ui.getActivePlayer().stop(),b.runningRefresh=!1):(b.lastcurrenttime=a.currentTime,b.runningRefresh=!0,b.States.CURRENT==b.States.BEGIN?(rspkr.hl.html5.States.setState(b.States.USER_START_NOT_READY),setTimeout(function(){b.refresh()},
200)):b.States.CURRENT==b.States.USER_START_NOT_READY?0<b.handlers.totalTime()&&(rspkr.HL.html5.rshlendCall||b.synclist[b.currentsyncindex]&&b.synclist[b.currentsyncindex][0]<1E3*b.handlers.totalTime())?(rspkr.hl.html5.States.setState(b.States.USER_START_PLAYING),rspkr.pl.playPromise(a),setTimeout(function(){b.refresh()},50)):0===b.handlers.totalTime()?(rspkr.pl.playPromise(a),setTimeout(function(){b.refresh()},250)):b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime?
setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75):b.States.CURRENT==b.States.USER_START_PLAYING&&(b.synclist[b.currentsyncindex]&&1*b.synclist[b.currentsyncindex][0]-20<1E3*a.currentTime&&(rspkr.HL.sync.execute(b.synclist[b.currentsyncindex][1],b.synclist[b.currentsyncindex][2]),b.currentsyncindex++),
b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75)))):(rspkr.log("[rspkr.hl.html5.refresh] Audio is undefined or player is stopped",2),b.runningRefresh=!1)}},Preserve:{cls:".rs_preserve",testElem:null,
elementShelter:[],formShelter:[],formData:function(a,b,e,f,c){this.name=a;this.type=b;this.value=e;this.checked=f;this.selectedIndex=c;this.selectedOptions=[]},moveToShelter:function(a){rspkr.HL.Preserve.cls=rspkr.cfg.item("general.preserveElements")?rspkr.cfg.item("general.preserveElements"):rspkr.HL.Preserve.cls;rspkr.log("[rspkr.HL.Preserve.moveToShelter]");var b=[],e=[],f=null,c=[];if(a.childNodes){for(var h=$rs.findIn(a,rspkr.HL.Preserve.cls),h=$rs.isArray(h)?h:[h],f=0;f<h.length;f++)for(var g=
f+1;g<h.length;g++)$rs.isArray($rs.findIn(h[f],h[g]))?$rs.isArray($rs.findIn(h[g],h[f]))||(h.splice(f,1),f--,g=h.length):(h.splice(g,1),g--);for(f=0;f<h.length;f++)c.push(h[f])}h=0;for(g=c.length;h<g;h++)f=$rs.get(c[h]).cloneNode(!1),c[h].parentNode.insertBefore(f,c[h]),b.push($rs.detach(c[h]));rspkr.log("[rspkr.hl.Preserve] Moved "+h+" nodes to the shelter.");a=$rs.findIn(a,"input, select");for(h=0;h<a.length;h++){c=new rspkr.HL.Preserve.formData(a[h].name,a[h].type,a[h].value,a[h].checked,a[h].selectedIndex);
if("select-multiple"==a[h].type){for(var f=a[h].options,g=[],k=0;k<f.length;k++)g.push(f[k].selected);c.selectedOptions=g}e.push(c)}rspkr.HL.Preserve.elementShelter.push(b);rspkr.HL.Preserve.formShelter.push(e)},restoreFromShelter:function(a){var b=[],e,f;rspkr.log("[rspkr.HL.Preserve.restoreFromShelter]");if(rspkr.HL.Preserve.elementShelter.length&&(f=rspkr.HL.Preserve.elementShelter.shift(),f.length)){if(a.childNodes){var c=$rs.findIn(a,rspkr.HL.Preserve.cls),c=$rs.isArray(c)?c:[c];for(e=0;e<c.length;e++)for(var g=
e+1;g<c.length;g++)$rs.isArray($rs.findIn(c[e],c[g]))?$rs.isArray($rs.findIn(c[g],c[e]))||(c.splice(e,1),e--,g=c.length):(c.splice(g,1),g--);for(e=0;e<c.length;e++)b.push(c[e])}c=0;for(g=b.length;c<g;c++)e=f.shift(),b[c].parentNode.insertBefore(e,b[c]),b[c].parentNode.removeChild(b[c])}if(rspkr.HL.Preserve.formShelter.length&&(a=$rs.findIn(a,"input, select"),b=rspkr.HL.Preserve.formShelter.shift(),a.length&&b.length&&a.length===b.length))for(c=0;c<a.length;c++)if(a[c].name===b[c].name)switch(a[c].type){case "text":a[c].value=
b[c].value;break;case "password":a[c].value=b[c].value;break;case "radio":!0===b[c].checked&&(a[c].checked=!0);break;case "checkbox":a[c].checked=b[c].checked;break;case "select-one":a[c].selectedIndex=b[c].selectedIndex;break;case "select-multiple":for(f=a[c].options,e=0;e<f.length;e++)f[e].selected=b[c].selectedOptions[e]}},clearShelter:function(){rspkr.log("[rspkr.HL.Preserve.clearShelter]");rspkr.HL.Preserve.elementShelter=[];rspkr.HL.Preserve.formShelter=[]}},Restore:{Storage:{readClass:[],readId:[],
restoreContent:[]},all:function(){rspkr.log("[rspkr.HL.Restore.all]");var a=rspkr.HL.Restore.Storage,b=[],e=null,f=/sync_(word|sent)/gi;if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);if(a.readId.length||a.restoreContent.length||a.readClass.length){var e=$rs.flatten?$rs.flatten(a.readClass):a.readClass,c=$rs.flatten?$rs.flatten(a.readId):a.readId,e=e.length?("."+e.join(",.")).split(","):[],e=c.length?e.concat(("#"+c.join(",#")).split(",")):e;if(rspkr.cfg.item("general.readidOrder")&&
rspkr.cfg.item("general.usePost"))for(var c=0,g=e.length;c<g;c++)b.push($rs.get(e[c]));else b=$rs.get(e.join(","));b=$rs.flatten(b);$rs.isArray(b)||(b=[b]);for(c=0;e=b[c];c++)!0===f.test(e.innerHTML)&&(rspkr.HL.Preserve.moveToShelter(e),e.innerHTML=a.restoreContent[c],rspkr.HL.Preserve.restoreFromShelter(e))}else rspkr.log("No stored content exists!",2);rspkr.c.dispatchEvent("onAfterContentChange",window)}a.readId.length=0;a.readClass.length=0},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",
1);!1===this.hasMarkup()&&rspkr.hl.State.CURRENT==rspkr.hl.State.STOPPED&&rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&(this.clearRestoreContent(),this.setRestoreContent(),rspkr.pl.releaseAdapter(),rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},hasMarkup:function(){var a=rspkr.HL.Restore.Storage,b=[],e=null,f=/sync_(word|sent)/gi,e=$rs.flatten?$rs.flatten(a.readClass):a.readClass,c=$rs.flatten?$rs.flatten(a.readId):a.readId,e=e.length?("."+e.join(",.")).split(","):[],e=c.length?e.concat(("#"+
c.join(",#")).split(",")):e;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(c=0;c<e.length;c++){var g=$rs.get(e[c]);$rs.isArray(g)&&0<g.length?b.concat(g):$rs.isArray(g)||b.push(g)}else b=$rs.get(e.join(","));$rs.isArray(b)||(b=[b]);if(b.length&&a.restoreContent.length)for(c=0;e=b[c];c++)if(f.test(e.innerHTML))return!0;return!1},clearRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!");
if("Explorer"===rs.c.data.browser.name&&9>=rs.c.data.browser.version)for(var a=document.body.getElementsByTagName("style"),b=0,e;e=a[b];b++){e.parentNode.removeChild(e);document.getElementsByTagName("head")[0].appendChild(e);var f=e.innerHTML;if(-1!=f.indexOf("@import")){for(var c=f.split("\n"),g,f=0,k;k=c[f];f++)if("@import"===k.substring(0,7)){f=k.replace(/;/g,"").replace("@import ","").replace("url(","").replace(")","").replace(/\"/g,"").replace(/\'/g,"").split(" ");for(c=0;c<f.length;c++){var m=
f[c].replace(/ /g,"");if(m){g=m;break}}break}e=e.sheet?e.sheet:e.styleSheet;e.insertRule?e.insertRule(k,0):e.addImport&&e.addImport(g)}}a=rspkr.HL.Restore.Storage;b=[];g=/sync_(word|sent|user)/gi;k=a.restoreContent;0===a.readClass.length&&0===a.readId.length&&rspkr.HL.Restore.getReadData();if(0==a.readClass.length&&0==a.readId.length)rspkr.log("ERR: Could not set restore content or find the read area data",3);else{e=$rs.flatten?$rs.flatten(a.readClass):a.readClass;f=$rs.flatten?$rs.flatten(a.readId):
a.readId;e=e.length?("."+e.join(",.")).split(","):[];e=f.length?e.concat(("#"+f.join(",#")).split(",")):e;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(f=0,c=e.length;f<c;f++)b.push($rs.get(e[f]));else b=$rs.get(e.join(","));b=$rs.flatten(b);$rs.isArray(b)||(b=[b]);a.restoreContent=[];for(f=0;e=b[f];f++)!1===g.test(e.innerHTML)?a.restoreContent.push(e.innerHTML):0<k.length&&k[f]?a.restoreContent.push(k[f]):a.restoreContent.push(e.innerHTML)}},getReadData:function(){rspkr.log("[rspkr.HL.Restore.getReadData]");
var a=rspkr.HL.Restore.Storage,b;b=rspkr.ui.getActivePlayer()?$rs.findIn(rspkr.ui.getActivePlayer().getContainer(),".rsbtn_play"):$rs.findIn($rs.get("."+rs.ui.rsbtnClass),".rsbtn_play");$rs.isArray(b)||(b=[b]);for(var e=0,f=b.length;e<f;e++){var c=b[e].getAttribute("href").match(/readspeaker.?.com\/cgi-bin\/.*rsent/gi);rspkr.cfg.item("general.servercall")&&(c=c?c:-1<b[e].getAttribute("href").indexOf(rspkr.cfg.item("general.servercall")));b[e].getAttribute("href")&&-1!==(b[e].getAttribute("href").indexOf(rspkr.cfg.item("general.domain")+
"/cgi-bin/"+rspkr.cfg.item("general.rsent"))||c)&&"rsSaveBtn"!==b[e].id&&"rs_selimg"!==b[e].id&&(-1!==b[e].getAttribute("href").search(/readclass=/)&&(c=b[e].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=",""),c=c.split(","),rspkr.HL.Restore.Storage.readClass.push(c)),-1!==b[e].getAttribute("href").search(/readid=/)&&(c=b[e].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=",""),c=c.split(","),rspkr.HL.Restore.Storage.readId.push(c)))}0===a.readClass.length&&
0===a.readId.length&&(rspkr.c.data.params.hasOwnProperty("readid")?a.readId.push([rspkr.c.data.params.readid]):rspkr.c.data.params.hasOwnProperty("readclass")&&a.readClass.push([rspkr.c.data.params.readclass]))}},Scroll:{currentSpan:null,timer:null,useScroll:!1,userScrollTimer:null,stopped:!0,getScrollY:function(){var a=0;"number"==typeof document.pageYOffset?a=document.pageYOffset:document.documentElement&&document.documentElement.scrollTop&&0<document.documentElement.scrollTop?a=document.documentElement.scrollTop:
document.body&&document.body.scrollTop&&(a=document.body.scrollTop);return a},getWindowHeight:function(){var a=0;"number"==typeof window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&0<document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight);return a+30},userScroll:function(){rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=
null);rspkr.HL.Scroll.userScrollTimer&&clearTimeout(rspkr.HL.Scroll.userScrollTimer);rspkr.HL.Scroll.userScrollTimer=setTimeout(function(){rspkr.HL.Scroll.userScrollTimer=null},5E3)},stopTimer:function(){rspkr.log("[rspkr.Hl.Scroll.stopTimer] Called!");rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.stopped=!0},initScroll:function(){"scrollon"==rspkr.Common.Settings.get("hlscroll")?(rspkr.log("[rspkr.HL.Sroll.initScroll] Scroll initiated!"),
rspkr.HL.Scroll.useScroll=!0,rspkr.evt("onUIClosePlayer",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIStop",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIPause",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUISliderMove",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusIn",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusOut",rspkr.HL.Scroll.userScroll),document.addEventListener?document.addEventListener("scroll",function(){setTimeout(function(){rspkr.HL.Scroll.userScroll()},0)},!1):document.attachEvent?document.attachEvent("onscroll",
rspkr.HL.Scroll.userScroll):document.onscroll=rspkr.HL.Scroll.userScroll):this.useScroll=!1},execScroll:function(a){this.useScroll&&(this.currentSpan=a,!0===this.stopped&&(this.stopped=!1),this.timer||(rspkr.log("[rspkr.hl.Scroll] execScroll"),this.timer=setTimeout(function(){rspkr.HL.Scroll.timer=null;rspkr.HL.Scroll.triggerScroll(rspkr.HL.Scroll.currentSpan)},500)))},triggerScroll:function(a){rspkr.log("[rspkr.HL.Scroll.triggerScroll] timer: "+rspkr.hl.Scroll.userScrollTimer+", stopped: "+rspkr.HL.Scroll.stopped);
rspkr.HL.Scroll.userScrollTimer||!1!==rspkr.HL.Scroll.stopped||rspkr.u.scroll.scrollToElm(a)}},State:{CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(a){this.CURRENT=a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},sync:{init:function(){rspkr.c.dispatchEvent("onBeforeSyncInit",window);m.hlChanged=!1;if(0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)rspkr.log("[rspkr.HL._sync.init] client markup"),rspkr.HL.Type.CURRENT=
rspkr.HL.Type.CLIENT_MARKUP,b.firstRun=1,"explorer"==a?document.selection.empty():b.preProcess.identifyElementsReplacementNode(document.body);else if(rspkr.log("[rspkr.HL._sync.init] server markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.SERVER_MARKUP,"none"!=rspkr.Common.data.sync){var g=[],k=[],e=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&(e=e.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(",")));rspkr.c.data.params.hasOwnProperty("readclass")&&
rspkr.c.data.params.readclass.length&&(e=e.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var f=0;f<e.length;f++){var c=$rs.get(e[f]);$rs.isArray(c)&&0<c.length?g.concat(c):$rs.isArray(c)||g.push(c)}else g=$rs.get(e.join(","));$rs.isArray(g)||(g=[g]);if("flash"==rspkr.PlayerAPI.adapter)for(e=rspkr.HL.markedUpHTML.join("").split("\x3c!--RSPEAK_STOP--\x3e"),f=0;e[f];f++);else e=rspkr.HL.markedUpHTML;
for(f=0;c=g[f];f++)c=c.nodeName&&"TABLE"==c.nodeName?document.createElement("TABLE"):document.createElement("DIV"),c.innerHTML=e[f],k.push(c);rspkr.log("[rspkr.HL.sync.init] readElements length: "+g.length);if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);for(f=0;f<g.length;f++)rspkr.HL.Preserve.moveToShelter(g[f]),g[f].innerHTML=k[f].innerHTML,rspkr.HL.Preserve.restoreFromShelter(g[f]);rspkr.c.dispatchEvent("onAfterContentChange",window);rspkr.HL.Preserve.clearShelter()}}rspkr.HL.markedUpHTML.length=
0;rspkr.c.post.removeIframe();rspkr.c.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.log("[rspkr.HL._sync.lightCleanUp] Called! "+rspkr.HL.Type.CURRENT);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!0===m.hlChanged?b.postProcess.settingsCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!1===m.hlChanged||0<rspkr.Common.data.selectedText.length?b.postProcess.lightCleanUp():rspkr.HL.Type.CURRENT==
rspkr.HL.Type.SERVER_MARKUP&&g.postProcess.lightCleanUp();rspkr.HL.html5.frameUrl=""},fullCleanUp:function(){rspkr.log("[rspkr.HL._sync.fullCleanUp] Called!");rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&b.postProcess.fullCleanUp();g.postProcess.fullCleanUp()},setId:function(a){rspkr.log("[rspkr.HL._sync.setId] Called!")},setClass:function(a){rspkr.log("[rspkr.HL._sync.setClass] Called!")},setContent:function(a){rspkr.log("[rspkr.HL._sync.setContent] Called!");
rspkr.HL.markedUpHTML.push(a)},execute:function(a,b){var e=rspkr.Common.Settings;if("none"!==e.get("hl")&&"hloff"!==e.get("hltoggle")){if(rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP){var f=$rs.hasClass($rs.get("#sync"+b),"sync_sent")?"sent":"word";if("sent"===e.get("hl")&&"word"===f||"word"===e.get("hl")&&"sent"===f)return}rspkr.c.dispatchEvent("onBeforeSync",window,[a,b]);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP?(e=rspkr.cfg.item("general.selectionEngine"),!e||"new"!==e&&"newcontent"!==
e?rspkr.HL.clientMarkup.sync(a,b):rspkr.HL.clientMarkup.syncNew(a,b)):rspkr.HL.serverMarkup.sync(a,b);rspkr.c.dispatchEvent("onAfterSync",window,[a,b])}}},settings:m,Type:{CURRENT:0,DEFAULT:0,SERVER_MARKUP:1,CLIENT_MARKUP:2}}}();rspkr.HL.engine||(rspkr.HL.engine={});
rspkr.HL.engine.explorer=function(){return{clientExtension:{firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[],wordsRangeClasses:[],originalParentContent:"",originalParent:null,preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;
var a;a="new"===rspkr.cfg.item("general.selectionEngine")||"newcontent"===rspkr.cfg.item("general.selectionEngine")?this.buildMarkupNew(rspkr.Common.data.selectedRange):this.buildMarkup(rspkr.Common.data.selectedRange);a.replace(/  +/g," ");rspkr.Common.data.selectedHTML=a;rspkr.hl.clientMarkup.originalParent=rspkr.c.data.selectedRange.parentElement();rspkr.hl.clientMarkup.originalParentContent=rspkr.c.data.selectedRange.parentElement().innerHTML},buildMarkup:function(a){for(var b=rspkr.c.data.getParam("lang"),
g=!1,k=null,m=rspkr.cfg.item("general.sentOnlyLang"),n=0;n<m.length;n++)if(b&&b.toLowerCase()===m[n]){g=!0;break}var b=a.duplicate(),n=0,m="",l=1,e=0,f=0,c="",h="",w=null;a.moveStart("word",-1);a.moveStart("word",1);b.isEqual(a)||a.moveStart("word",-1);b=a.duplicate();a.moveEnd("word",1);a.moveEnd("word",-1);b.isEqual(a)||a.moveEnd("word",1);rspkr.HL.clientMarkup.selectionRange=a.duplicate();var q=a.parentElement(),u=a.duplicate();u.collapse(!1);b=a.duplicate();b.collapse();for(g&&(k=a.text.split(new RegExp(decodeURIComponent("%e3%80%81")+
"|"+decodeURIComponent("%e3%80%82")+"|"+decodeURIComponent("%DB%94")+"|"+decodeURIComponent("%D8%8C"))));a.inRange(b)&&0!=a.compareEndPoints("EndToEnd",b);){f++;n++;if(1E4<n)break;if(g)if(b=a.duplicate(),k[f-1])b.findText(k[f-1]);else break;else b.collapse(!1),b.expand("word",1);h=c="";u.collapse(!1);var p=b.duplicate();p.collapse(!1);if(0==u.compareEndPoints("StartToStart",p)&&0==u.compareEndPoints("EndToEnd",p)&&p.htmlText==u.htmlText&&/\W/.test(p.text)){e++;if(2>e)b.move("character",1);else if(4>
e)b.move("character",2);else if(6>e)b.move("word",1);else if(8>e)b.move("word",2);else if(10>e)b.move("sentence",1);else if(12>e)b.move("sentence",2);else break;b.collapse(!1)}else{e=0;if(-1===f)return b;rspkr.HL.clientMarkup.selectedWordsRange[f]=b.duplicate();u=b.text;p=b.htmlText;b.collapse(!1);var x;1===l?(w=b.duplicate(),x=this.iterateParentTree(w.parentElement(),document.body,q,0)):x=this.iterateParentTree(b.parentElement(),w.parentElement(),q,0);for(var v=this.iterateParentTree(w.parentElement(),
b.parentElement(),q,0),r=b.parentElement(),t=0;t<x&&20>t;t++)r.className.match("sync_")||(c=r.outerHTML.match("<[^>]*>")[0]+c),r=r.parentElement;r=w.parentElement();for(t=0;t<v&&20>t;t++)r.className.match("sync_")||(h+="</"+r.tagName+">"),r=r.parentElement;if(0!=x||0!=v)w=b.duplicate();1===l?(m+=c,l=0):m+=h+c;""!=p.replace("sync_sent_highlighted","")&&(c=f,h=$rs.get("#sync"+f),$rs.isArray(h)&&0<h.length&&(c=Math.floor(1E3*Math.random()+1E3)),m+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user" id="sync'+
c+'">'+u+"</"+rspkr.Common.data.browser.syncContainer+">");u=b.duplicate()}}m+="\x3c!-- f --\x3e";v=this.iterateParentTree(w.parentElement(),document.body,q,0);r=w.parentElement();for(t=0;t<v;t++)r.className.match("sync_")||(m+="</"+r.tagName+">"),r=r.parentElement;b.collapse();return m},buildMarkupNew:function(a){for(var b=rspkr.c.data.getParam("lang"),g=!1,k=rspkr.cfg.item("general.sentOnlyLang"),m=0;m<k.length;m++)if(b&&b.toLowerCase()===k[m]){g=!0;break}var b=a.duplicate(),k="",n=1,l=0,e=0,f=
"",c="",h="",w=null,m=0;rspkr.HL.clientMarkup.selectionRange=a.duplicate();var q=a.parentElement(),u=a.duplicate(),h=a.duplicate();u.collapse(!1);b.collapse();var p=[],x=h.duplicate(),f=h.duplicate();h.moveStart("sentence",-1);h.moveStart("sentence",1);x.isEqual(h)||h.moveStart("sentence",-1);x=h.duplicate();h.moveEnd("sentence",1);h.moveEnd("sentence",-1);x.isEqual(h)||h.moveEnd("sentence",1);x=h.duplicate();f.collapse(!0);for(h.collapse(!0);x.inRange(h)&&0!=x.compareEndPoints("EndToEnd",h);){f.expand("sentence",
1);if(!0===f.isEqual(h)||0===f.compareEndPoints("EndToEnd",h))break;h.expand("sentence",1);p.push(f.duplicate())}for(;!1===a.inRange(p[0])&&0!=a.compareEndPoints("StartToStart",p[0]);)p[0].moveStart("word",1);for(;!1===a.inRange(p[p.length-1])&&0!=a.compareEndPoints("EndToEnd",p[p.length-1]);)p[p.length-1].moveEnd("word",-1);for(x=0;x<p.length;x++){for(h="";p[x].inRange(b)&&0!=p[x].compareEndPoints("EndToEnd",b);){e++;m++;if(1E4<m)break;g?(b=a.duplicate(),b.findText(null[e-1])):(b.collapse(!1),b.expand("word",
1));c=f="";u.collapse(!1);var v=b.duplicate();v.collapse(!1);if(0==u.compareEndPoints("StartToStart",v)&&0==u.compareEndPoints("EndToEnd",v)&&v.htmlText==u.htmlText){l++;if(2>l)b.move("character",1);else if(4>l)b.move("character",2);else if(6>l)b.move("word",1);else if(8>l)b.move("word",2);else if(10>l)b.move("sentence",1);else if(12>l)b.move("sentence",2);else break;b.collapse(!1)}else{l=0;if(-1===e)return b;rspkr.HL.clientMarkup.selectedWordsRange[e]=b.duplicate();rspkr.HL.clientMarkup.wordsRangeClasses[e]=
"word";u=b.text;v=b.htmlText;b.collapse(!1);var r;1===n?(w=b.duplicate(),r=this.iterateParentTree(w.parentElement(),document.body,q,0)):r=this.iterateParentTree(b.parentElement(),w.parentElement(),q,0);for(var t=this.iterateParentTree(w.parentElement(),b.parentElement(),q,0),y=b.parentElement(),z=0;z<r&&20>z;z++)y.className.match("sync_")||(f=y.outerHTML.match("<[^>]*>")[0]+f),y=y.parentElement;y=w.parentElement();for(z=0;z<t&&20>z;z++)y.className.match("sync_")||(c+="</"+y.tagName+">"),y=y.parentElement;
if(0!=r||0!=t)w=b.duplicate();1===n?(h+=f,n=0):h+=c+f;""!=v.replace("sync_sent_highlighted","")&&(f=e,c=$rs.get("#sync"+e),$rs.isArray(c)&&0<c.length&&(f=Math.floor(1E3*Math.random()+1E3)),h+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word" id="sync'+f+'">'+u+"</"+rspkr.Common.data.browser.syncContainer+">");u=b.duplicate()}}e++;rspkr.HL.clientMarkup.selectedWordsRange[e]=p[x];rspkr.HL.clientMarkup.wordsRangeClasses[e]="sent";f=e;c=$rs.get("#sync"+e);$rs.isArray(c)&&0<c.length&&
(f=Math.floor(1E3*Math.random()+1E3));k+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent" id="sync'+f+'">';k+=h;k+="</"+rspkr.Common.data.browser.syncContainer+">\n"}t=this.iterateParentTree(w.parentElement(),document.body,q,0);y=w.parentElement();for(z=0;z<t;z++)y.className.match("sync_")||(k+="</"+y.tagName+">"),y=y.parentElement;b.collapse();return k},iterateParentTree:function(a,b,g,k){for(var m=b;null!==m;){if(a==g||a==m)return k;m=m.parentElement}k++;return this.iterateParentTree(a.parentElement,
b,g,k)}},postProcess:{lightCleanUp:function(){rspkr.log("[clientMarkup.postProcess.lightCleanUp] called!");for(var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),b=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),b=$rs.isArray(b)?b:[b],a=b.length-1;-1<a;a--)b[a].className=b[a].className.replace("sync_sent_highlighted","sync_sent"),b[a].className=b[a].className.replace("sync_word_highlighted",
"sync_word"),-1===b[a].className.toLowerCase().indexOf("sync_user")&&(b[a].removeAttribute("id"),b[a].removeAttribute("color"));var b=rspkr.HL.clientMarkup.previousWord.range,g=rspkr.HL.clientMarkup.previousWord.forecolor,k=rspkr.HL.clientMarkup.previousWord.backcolor,m=rspkr.HL.clientMarkup.previousSent.range,n=rspkr.HL.clientMarkup.previousSent.forecolor,l=rspkr.HL.clientMarkup.previousSent.backcolor;if(b&&0<b.length)for(var a=0,e=b.length;a<e;a++)null!==k[a]&&(b[a].execCommand("backcolor",0,k[a]),
null!==g[a]&&b[a]&&b[a].execCommand("forecolor",0,g[a]));if(b&&0<m.length)for(a=0,e=m.length;a<e;a++)null!==l[a]&&(m[a].execCommand("backcolor",0,l[a]),null!==n[a]&&m[a]&&m[a].execCommand("forecolor",0,n[a]));rspkr.hl.clientMarkup.lastWord=null},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");if(null===rspkr.hl.clientMarkup.originalParent)this.lightCleanUp();else{var a=rspkr.hl.clientMarkup.originalParent;rspkr.hl.Preserve.moveToShelter(a);
a.innerHTML=rspkr.hl.clientMarkup.originalParentContent;rspkr.hl.Preserve.restoreFromShelter(a)}rspkr.hl.clientMarkup.selectedWordsRange=[];rspkr.hl.clientMarkup.selectionRange=null;rspkr.hl.clientMarkup.originalParentContent="";rspkr.hl.clientMarkup.originalParent=null;rspkr.hl.clientMarkup.lastWord=null}},sync:function(a,b){var g=!1,k;0===(a&2)&&(g=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=
[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]);k=this.selectedWordsRange[b];if(1===this.firstRun){this.firstRun=0;if(0<this.previousSent.range.length){for(var m=0,n=this.previousSent.range.length;m<n;m++)this.previousSent.range[m].execCommand("backcolor",0,this.previousSent.backcolor[m]),null!==this.previousSent.forecolor[m]&&this.previousSent.range[m].execCommand("forecolor",0,this.previousSent.forecolor[m]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}rspkr.HL.clientMarkup.selectionRange&&"wordsent"===rspkr.st.get("hl")&&(this.previousSent.range.push(rspkr.HL.clientMarkup.selectionRange),this.previousSent.backcolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("backcolor")),this.previousSent.forecolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("forecolor")),this.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext")))}if(!g&&
0<this.previousWord.range.length){for(m=0;m<this.previousWord.range.length;m++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[m].execCommand("backcolor",0,this.previousWord.backcolor[m]):this.previousWord.range[m].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[m].execCommand("forecolor",0,this.previousWord.forecolor[m]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(k.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(k.queryCommandValue("forecolor"));this.previousWord.range.push(k);"sent"==rspkr.st.get("hl")?(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.sentHL(k,a),k.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"))):(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(k,a),k.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")));this.lastWord=k;rspkr.HL.customHL&&rspkr.HL.customHL.active();k.execCommand("forecolor",
0,rspkr.Common.Settings.get("hltext"))},syncNew:function(a,b){var g=!1;0===(a&2)&&(g=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[],this.firstRun=0);var k=this.selectedWordsRange[b];if(k&&"word"===this.wordsRangeClasses[b]&&("word"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length&&!g){for(g=0;g<
this.previousWord.range.length;g++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[g].execCommand("backcolor",0,this.previousWord.backcolor[g]):this.previousWord.range[g].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[g].execCommand("forecolor",0,this.previousWord.forecolor[g]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(k.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(k.queryCommandValue("forecolor"));this.previousWord.range.push(k);k.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword"));this.lastWord=k;k.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}else if(k&&"sent"===this.wordsRangeClasses[b]&&("sent"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length){for(g=0;g<this.previousWord.range.length;g++)this.previousWord.range[g].execCommand("backcolor",0,this.previousWord.backcolor[g]),
this.previousWord.range[g].execCommand("forecolor",0,this.previousWord.forecolor[g]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}if(0<this.previousSent.range.length){for(g=0;g<this.previousSent.range.length;g++)this.previousSent.range[g].execCommand("backcolor",0,this.previousSent.backcolor[g]),this.previousSent.range[g].execCommand("forecolor",0,this.previousSent.forecolor[g]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}this.previousSent.backcolor.push(k.queryCommandValue("backcolor"));this.previousSent.forecolor.push(k.queryCommandValue("forecolor"));this.previousSent.range.push(k);k.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"));k.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}}}}}();
rspkr.HL.engine.gecko=function(){return{clientExtension:{preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;var a="",a=rspkr.Common.data.selectedRange;this.startNode=a.startContainer;this.endNode=a.endContainer;this.startOffset=this.modifyOffsetStartOfWord(this.startNode,
a.startOffset);this.endOffset=this.modifyOffsetEndOfWord(this.endNode,a.endOffset);a=this.buildMarkup(a.commonAncestorContainer);a.replace(/  +/g," ");window.getSelection().removeAllRanges();rspkr.Common.data.selectedHTML=a},buildMarkup:function(a){this.firstRun=1;var b="",g=this.inc;if(3==a.nodeType)b+=this.textMarkup(a);else{var k,m="";if(a.hasChildNodes())for(k=0;k<a.childNodes.length;k++){var n=a.childNodes.item(k);n==this.startNode&&(this.inc=1);a==this.startNode&&k==this.startOffset&&(this.inc=
1);8!=n.nodeType&&(m+=this.buildMarkup(n));if(a==this.endNode&&k==this.endOffset){this.inc=0;break}if(n==this.endNode){this.inc=0;break}}k=!0;null!=$rs.getAttr(a,"id")&&(k=$rs.getAttr(a,"id").replace("sync")===$rs.getAttr(a,"id"));(g||this.inc)&&(!a.className||a.className.replace("sync")===a.className&&k)?(g=document.createElement("div"),g.appendChild(a.cloneNode(!0)),tempdivtag=g.innerHTML.match("<[^>]*>"),null!==tempdivtag&&0<tempdivtag.length?(b+=tempdivtag[0],b=b+m+("</"+a.nodeName+">")):b+=m):
b+=m;if(a.hasChildNodes())for(k=0;k<a.childNodes.length;k++){if(a===this.endNode&&k===this.endOffset){this.inc=0;break}if(n===this.endNode){this.inc=0;break}}}return b},textMarkup:function(a){var b=!0,g="",k,m="",n="",l=a.nodeValue;a===this.startNode&&-1!==this.startOffset&&a===this.endNode&&-1!==this.endOffset?(m=a.nodeValue.substring(0,this.startOffset),l=a.nodeValue.substring(this.startOffset,this.endOffset),n=a.nodeValue.substring(this.endOffset),this.inc=1):a===this.startNode&&-1!==this.startOffset?
(m=a.nodeValue.substring(0,this.startOffset),l=a.nodeValue.substring(this.startOffset),this.inc=1):a===this.endNode&&-1!==this.endOffset&&(l=a.nodeValue.substring(0,this.endOffset),n=a.nodeValue.substring(this.endOffset),this.inc=1);if(!this.inc)return"";for(k=0;k<this.excludednodes.length;k++)if(a.parentNode&&a.parentNode.nodeName.toLowerCase()===this.excludednodes[k]){b=!1;g=this.htmlencode(l);break}b&&(g=rspkr.cfg.item("general.selectionEngine"),g=!g||"new"!==g&&"newcontent"!==g?this.markupSentences(this.htmlencode(l),
null):this.markupSentencesNew(this.htmlencode(l),null));a===this.endNode&&-1!==this.endOffset&&(this.inc=0);if(rs.cfg.item("general.enableSkipAlways")){k=a;for(var e=!1;k.parentNode;){if(/rs_skip_always/i.test(k.className)){e=!0;break}k=k.parentNode}e&&(g='<span class="rs_skip_always">'+g+"</span>")}b&&null!==a.parentNode&&""!==l&&(b=this.createreplacementnode(m+g+n,getComputedStyle(a.parentNode,null)),a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a));return g},markupSentencesNew:function(a){a=
this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",g="",k=!1,m=0;m<a.length;m++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent cj'+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[m])?(k=!0,g=a[m].slice(0,-1)):g=a[m],b+=this.markupWords(g),b+="</"+rspkr.Common.data.browser.syncContainer+">",
!0===k&&(b+=" "),k=!1;return b},markupSentences:function(a){a=this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",g="",k=!1,m=0;m<a.length;m++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[m])?(k=!0,g=a[m].slice(0,-1)):g=a[m],
b+=this.markupWords(g),!0===k&&(b+=" "),b+="</"+rspkr.Common.data.browser.syncContainer+">",k=!1;return b},markupWords:function(a){a=this.splitString(a," ");if(!a)return"";for(var b="",g="",k=!1,m=0;m<a.length;m++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',b+=' id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[m])?(k=!0,g=a[m].slice(0,-1)):g=a[m],b+=g,b+="</"+rspkr.Common.data.browser.syncContainer+">",!0===k&&(b+=" "),k=!1;
return b},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},htmlencode:function(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},identifyElementsReplacementNode:function(a){a.tagName&&a.tagName.toLowerCase()==rspkr.Common.data.browser.syncContainer&&a.id&&(rspkr.HL.clientMarkup.selectedWordsRange[a.id]=a);if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)this.identifyElementsReplacementNode(a.childNodes[b])},createreplacementnode:function(a,
b){var g=document.createElement(rspkr.Common.data.browser.syncContainer);g.innerHTML=a;g.setAttribute("class","synctemp cl"+this.numberOfSelections);return g},modifyOffsetStartOfWord:function(a,b){for(var g=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&0!=b;){for(var k=0;k<g.length;k++)if(breakstr=g[k],0==a.nodeValue.substring(b).indexOf(breakstr))return b;b--}return b},modifyOffsetEndOfWord:function(a,
b){for(var g=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&b!=a.nodeValue.length;){for(var k=0;k<g.length;k++)if(breakstr=g[k],0==a.nodeValue.substring(b-1).indexOf(breakstr))return b;b++}return b},returnClassArraySubstring:function(a){a=$rs.get("."+a);return a=$rs.isArray(a)?a:[a]},splitString:function(a,b){for(var g=[""],k=0,m=0;m<a.length;m++){for(var n=0;n<b.length;n++){for(var l=
b[n],e=!0,f=0;f<l.length;f++)if(0>a.length-(m+f)||l[l.length-f-1]!=a[m-f-1]){e=!1;break}e&&(k++,g[k]="")}g[k]+=a[m]}return g},endsWithSpace:function(a){return-1!==a.indexOf(" ",a.length-1)}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),a=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),
b,a=$rs.isArray(a)?a:[a];for(i=a.length-1;-1<i;i--)b=document.createDocumentFragment(),b.textContent=a[i].textContent,a[i].parentNode.replaceChild(b,a[i])},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),a=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),a=$rs.isArray(a)?a:[a];for(i=
a.length-1;-1<i;i--)rspkr.HL.chunking.continueHref||(a[i].className=a[i].className.replace("sync_sent_highlighted","sync_sent")),a[i].className=a[i].className.replace("sync_word_highlighted","sync_word"),rspkr.HL.chunking.continueHref||-1!==a[i].className.toLowerCase().indexOf("sync_user")||a[i].removeAttribute("id")},settingsCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.settingsCleanUp] called!");var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,
g=rspkr.HL.clientMarkup.previousSent.element,k=rspkr.HL.clientMarkup.previousSent.className;if(0<a.length){for(var m in a)a[m].className=b[m];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<g.length){for(m in g)g[m].className=k[m];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");var a=rspkr.HL.clientMarkup.previousWord.element,
b=rspkr.HL.clientMarkup.previousWord.className,g=rspkr.HL.clientMarkup.previousSent.element,k=rspkr.HL.clientMarkup.previousSent.className;if(0<a.length){for(var m in a)a[m].className=b[m];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<g.length){for(m in g)g[m].className=k[m];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}this.cleanUpSpans();rspkr.Common.data.selectedHTML=""}},sync:function(a,b){var g=
!1,k;0==(a&2)&&(g=0!=(a&1)?!0:!1);1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=[],this.previousSent.element=[],this.previousSent.className=[]);k=this.selectedWordsRange["sync"+b];if(k.className.replace("word","")!=k.className){rspkr.log("inside");if(0<this.previousWord.element.length&&0<this.previousWord.className.length&&!g){for(g=0;g<this.previousWord.element.length;g++)this.previousWord.element[g].className=this.previousWord.className[g];this.previousWord.element=
[];this.previousWord.className=[]}this.previousWord.element.push(k);this.previousWord.className.push(k.className);"sent"===rspkr.st.get("hl")?k.className=k.className.replace("sync_sent","sync_user sync_sent_highlighted"):(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(k,a),k.className=k.className.replace("sync_word","sync_user sync_word_highlighted"))}k&&rspkr.HL.Scroll.execScroll(k);if(1==this.firstRun){this.firstRun=0;if(0<this.previousSent.element.length){for(g=0;g<this.previousSent.element.length;g++)this.previousSent.element[g].className=
this.previousSent.className[g];this.previousSent.element=[];this.previousSent.className=[]}if("wordsent"==rspkr.st.get("hl"))for(k=this.preProcess.returnClassArraySubstring("ffsent"+this.preProcess.numberOfSelections+" "),g=0;g<k.length;g++)this.previousSent.element[g]=k[g],this.previousSent.className[g]=k[g].className,k[g].className="ffsent"+this.preProcess.numberOfSelections+" sync_sent_highlighted"}},syncNew:function(a,b){var g;1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=
[],this.previousSent.element=[],this.previousSent.className=[],this.firstRun=0);g=document.getElementById("sync"+b);if(g.className.replace("word","")!=g.className&&("word"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousWord.element.length&&0<this.previousWord.className.length){for(var k=0;k<this.previousWord.element.length;k++)this.previousWord.element[k].className=this.previousWord.className[k];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(g);
this.previousWord.className.push(g.className);g.className="sync_user sync_word_highlighted"}else if(g.className.replace("sent","")!=g.className&&("sent"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousSent.element.length&&0<this.previousSent.className.length){for(k=0;k<this.previousSent.element.length;k++)this.previousSent.element[k].className=this.previousSent.className[k];this.previousSent.element=[];this.previousSent.className=[]}this.previousSent.element.push(g);this.previousSent.className.push(g.className);
g.className=g.className.replace("sync_sent","sync_user sync_sent_highlighted")}g&&rspkr.HL.Scroll.execScroll(g)}}}}();
ReadSpeaker.ui=function(){var a=null,b=[],g=[],k=!1,m=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},n=function(){rspkr.log("[rspkr.ui] Attempting to add click events.");var a=$rs.get("."+rspkr.ui.rsbtnClass+" .rsbtn_play"),b=null;$rs.isArray(a)||(a=[a]);for(var c=0,e=a.length;c<e;c++)if($rs.unregEvent(a[c],"click",ReadSpeakerDefer.clickhandler),b=a[c]?$rs.getAttr(a[c],
"data-rsevent-id"):"_bogus_",rspkr.l.f.eq.store[b]&&rspkr.l.f.eq.store[b].click)rspkr.log("[rspkr.ui] Click event already existed on "+a[c],2);else{$rs.regEvent(a[c],"click",function(a){m(a);window.readpage(this)});rspkr.ui.addFocusHandler(a[c],!0,a[c].parentNode);rspkr.log("[rspkr.ui] Added click event to: "+a[c],1);try{$rs.getAttr(a[c],"role")||$rs.setAttr(a[c],"role","button")}catch(f){rspkr.log("[rspkr.ui] Could not add role attribute.",2)}}},l=function(a){for(var b=$rs.get("a"),c=0,e=b.length;c<
e;c++)if(b[c].href&&b[c].href==a)return b[c];return!1},e=function(a){for(var c in b)if(b[c]&&b[c].getContainer&&b[c].getContainer()==a)return b[c];a=new rspkr.ui.Player(a);b.push(a);return a},f=function(){rspkr.log("[rspkr.ui] Initiating global callbacks");rspkr.ui.rsbtnClass=rspkr.cfg.item("ui.rsbtnClass")||"rsbtn";window.readpage=function(a,b){if(rspkr.ui.initrun){if(/ios|ipad|iphone|ipod|android|windows phone/i.test(window.navigator.userAgent)){var c=window.rspkr;c.audio=new Audio;rspkr.pl.playPromise(c.audio,
c.audio.pause.bind(c.audio))}rspkr.ui.showPlayer(a,b)}};window.rshlexit=function(b){rspkr.HL.chunking&&rspkr.HL.chunking.destroy();void 0!==b&&"false"!==b||a.stop();setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",window)},1E3)};window.rshlinit=A().sync.init;window.rshlsetContent=A().sync.setContent;window.rshlsetId=A().sync.setId;window.rshlsync=function(a,b){for(var c=a.split(","),e=b.split(","),f=0,g=a.length;f<g;f++)A().sync.execute(c[f],e[f])};window.rshlcontinue=function(){function a(b){if(!rspkr.HL.chunking.entracte.src){b=
encodeURIComponent(decodeURIComponent(rs.cfg.getPhrase(b)));var c={noads:1},e;for(e in rspkr.c.data.params)rspkr.c.data.params.hasOwnProperty(e)&&(c[e]=rspkr.c.data.params[e]);e=rspkr.Common.data.selectedText;var f=rspkr.Common.data.selectedHTML;rspkr.Common.data.selectedText=b;rspkr.Common.data.selectedHTML="";c.text=b;c.output="audio";b=rspkr.c.buildReadSpeakerCall(c);rspkr.HL.chunking.entracte.src=b;rspkr.Common.data.selectedText=e;rspkr.Common.data.selectedHTML=f}rspkr.HL.chunking.entracte.volume=
parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.pl.playPromise(rspkr.HL.chunking.entracte)}if(rspkr.HL.chunking){rspkr.log("[rspkr.ui.rshlcontinue]");rspkr.HL.chunking.chunkEnded=!0;var b=$rs.get("#sync"+rspkr.HL.html5.synclist[rspkr.HL.html5.synclist.length-1][2]);$rs.isArray(b)&&!b.length?(b=0,document.body&&document.body.scrollTop?b=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?b=document.documentElement.scrollTop:window.pageYOffset&&(b=window.pageYOffset),
b={left:rs.ui.viewport.width/2,top:rs.ui.viewport.height/2+b}):b=$rs.offset(b);if(rspkr.HL.chunking.continueHref){var c=rspkr.cfg.item("cb.chunking.pause",void 0,!0);if(-1==rspkr.HL.chunking.continueTime)if(rspkr.log("[rspkr.ui.rshlcontinue] Waiting for user interaction"),rs.ui.getActivePlayer().pause(),$rs.addClass(rspkr.ui.getActivePlayer().getContainer(),"rsautopaused"),a("chunkcontinue"),c&&"function"==typeof c)rspkr.log("[rspkr.ui.rshlcontinue] Running custom callback",3),c();else{rspkr.log("[rspkr.ui.rshlcontinue] Showing default continue button");
c=document.createElement("div");c.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");$rs.addClass(c,rspkr.ui.rsbtnClass+" rspopup rsresume");var e=$rs.findIn(c,"a");e.removeAttribute("href");$rs.regEvent(e,"click",function(a){rspkr.c.dispatchEvent("onChunkResume",window)});$rs.findIn(e,".rsbtn_text").innerHTML="<span>"+rs.cfg.getPhrase("chunkbutton")+"</span>";document.body.appendChild(c);c.style.display="block";b.left+=15;e=b.left+$rs.width(c)-$rs.width(window);0<e&&(b.left-=e);c.style.left=b.left+
"px";c.style.top=b.top+15+"px"}else 0==rspkr.HL.chunking.continueTime?(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay"),rspkr.c.dispatchEvent("onChunkResume",window)):isNaN(rspkr.HL.chunking.continueTime)?rspkr.log("[rshlcontinue] Invalid time parameter!",3):(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay with "+rspkr.HL.chunking.continueTime+" seconds delay"),5<=rspkr.HL.chunking.continueTime&&a("chunkwait"),c&&"function"==typeof c&&c(rspkr.HL.chunking.continueTime),rspkr.HL.chunking.stall=!0,setTimeout(function(){rspkr.HL.chunking.stall=
!1},1E3*rspkr.HL.chunking.continueTime),rspkr.HL.chunking.timer=setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},1E3*rspkr.HL.chunking.continueTime))}else rspkr.log("[rshlcontinue] No continue href found!")}};var b=rspkr.c.data.browser;b&&(/iphone|ipad|ios|android|windows phone/i.test(b.OS)||"android"==b.name.toLowerCase())?($rs.regEvent(document.body,"touchstart",function(a){rspkr.ui.setPointerPos(a);return!0}),$rs.regEvent(document.body,"touchend",function(a){rspkr.ui.setPointerPos(a);
rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document,"selectionchange",function(a){rspkr.c.data.setSelectedText(a);return!0})):($rs.regEvent(document.body,"mousedown",function(a){rspkr.ui.setPointerPos(a);return!0}),$rs.regEvent(document.body,"mouseup",function(a){"opera"===b.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(window,"mouseup",function(a){"opera"===b.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},
50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(document.body,"keyup",function(a){rspkr.c.data.setSelectedText(a);return!0}))},c=function(){document.removeEventListener?document.removeEventListener("click",window.ReadSpeakerDefer.clickhandler,!1):document.detachEvent&&document.detachEvent("onclick",window.ReadSpeakerDefer.clickhandler);if(ReadSpeakerDefer.deferred){var a=ReadSpeakerDefer.deferred,b=null;if("a"!=a.tagName.toLowerCase()){for(b=
a;"body"!=b.tagName.toLowerCase()&&(b=b.parentNode,"a"!=b.tagName.toLowerCase()););a=b}ReadSpeakerDefer.isRSLink(a)&&(rspkr.log("[rspkr.ui] Activating deferred element: "+a),$rs.removeClass(a.parentNode,"rsdeferred"),rspkr.ui.showPlayer(a));ReadSpeakerDefer.deferred=null}},h=function(b,c,f){rspkr.log("[rspkr.ui.showPlayer]");f=f||!1;var g="string"==typeof b?l(b):b,h=g?$rs.closest(g,".rsexpanded"):void 0,h=$rs.hasClass(h,"pre-expanded")?void 0:h,k=rspkr.HL.chunking?rspkr.HL.chunking.currentChunkNumber:
1;if(h&&!$rs.isArray(h)&&rspkr.ui.getActivePlayer()&&1==k&&rspkr.ui.getActivePlayer().getContainer()==h)rspkr.HL.newPlayback=!1,rspkr.log("Player already active, calling Player.restart() instead"),rspkr.ui.getActivePlayer().restart();else{rspkr.HL.lpSelection&&rspkr.HL.sync.fullCleanUp();0<rspkr.c.data.selectedText.length?(rspkr.HL.lpSelection=!0,rspkr.HL.newPlayback=!0,rspkr.HL.sync.lightCleanUp()):rspkr.HL.lpSelection?(rspkr.HL.lpSelection=!1,rspkr.HL.newPlayback=!0):(rspkr.HL.lpSelection=!1,rspkr.HL.newPlayback=
!1);rspkr.HL.chunking&&rspkr.HL.chunking.destroy();rspkr.HL.chunking&&rspkr.HL.chunking.html5support&&(rspkr.HL.chunking.entracte=new Audio,/ios|ipad|iphone|ipod|android|windows phone/i.test(window.navigator.userAgent)&&rspkr.pl.playPromise(rspkr.HL.chunking.entracte,rspkr.HL.chunking.entracte.pause.bind(rspkr.HL.chunking.entracte)));rspkr.c.dispatchEvent("onBeforeParamsSet",window,[g]);h="string"==typeof b?b:$rs.getAttr(g,"href");k=null;"string"==typeof b&&(k=h.match(/readid=[^&]+/gi),b=h.match(/readclass=[^&]+/gi),
k&&0<k.length&&rspkr.HL.Restore.Storage.readId.push(k[0].replace("readid=","").split(",")),b&&0<b.length&&rspkr.HL.Restore.Storage.readClass.push(b[0].replace("readclass=","").split(",")));rspkr.c.data.selectedHTML="";rspkr.c.data.setParams(h);void 0!==$rs.getAttr(g,"data-target")&&null!==$rs.getAttr(g,"data-target")&&(k=$rs.getAttr(g,"data-target"),k=$rs.get(k),"object"===typeof k&&(c=k));c&&!f?(k=$rs.get(c),$rs.addClass(k,rspkr.ui.rsbtnClass+" rsfloating"),rspkr.basicMode&&($rs.removeClass(k,"rshidden"),
$rs.addClass(k,rspkr.ui.rsbtnClass+" rsvisible"))):k=$rs.closest(g,"div."+rspkr.ui.rsbtnClass);if(!0===rspkr.cfg.item("survey.allowed")){c=rspkr.c.cookie;f=rspkr.cfg.item("survey.cookieName")||"rspkrsurvey";g=rspkr.cfg.item("survey.cookieLifetime")||15552E6;b=rspkr.c.data.params;if("1"===c.readKey(f,"nmbrdisplays")){rspkr.ui.Lightbox.show(rspkr.cfg.item("survey.url")+"?customerid="+b.customerid+"&lang="+b.lang,rspkr.st.r().replaceTokens(rspkr.cfg.item("ui.survey.buttons").join(),{rsSURVEY_BUTTON_CLOSErs:rspkr.cfg.getPhrase("close")}),
!0,function(a){$rs.regEvent($rs.get("#rssurvey_button_close"),"click",rspkr.u.Lightbox.hide)},500);rspkr.log(c.updateKey(f,"nmbrdisplays","displayed",g),4);return}void 0===c.readKey(f,"nmbrdisplays")&&rspkr.log(c.updateKey(f,"nmbrdisplays","1",g),4)}c=e(k);if(a&&a!=c||a&&h!==a.getHref())a.close(!0),rspkr.c.dispatchEvent("onUIClosePlayer",a.getContainer(),[0<rspkr.c.data.selectedText.length?"textsel":"nosel"]);f=(f=a)?f.getID():null;rspkr.c.dispatchEvent("onUIShowPlayer",window,[f,c.getID()]);c.setHref(h);
a=c;c.show();return a}},w=function(b,c){c=c||a.getContainer();var f=$rs.findIn(c,".rsbtn_status");0===f.length&&(f=document.createElement("span"),f.className="rsbtn_status_overlay",f.innerHTML='<span class="rsbtn_status"></span>',$rs.findIn(c,".rsbtn_exp").appendChild(f),f=$rs.findIn(c,".rsbtn_status"));$rs.css($rs.findIn(c,".rsbtn_status_overlay"),"display","block");if("nosound"===b)b='<a class="rsbtn_nosound">'+rspkr.cfg.getPhrase("nosound")+"</a>",f.innerHTML=b,(f=$rs.findIn(c,".rsbtn_nosound"))&&
$rs.regEvent(f,"click",function(b){return a.nosound()});else if("loaderror"===b){var e=rspkr.c.data.getSaveData("link"),g=document.createElement("a");g.className="rsbtn_loaderror";g.innerHTML="[?]";g.href=e;$rs.regEvent(g,"click",function(a){rspkr.ui.Lightbox.show("<iframe src='"+g.href+"' style='height:100%'></iframe>",null,!1,null,300);m(a)});f.innerHTML=rspkr.cfg.getPhrase("loaderror")||"An error has occurred, try again";f.appendChild(g)}else f.innerHTML=b},q=function(a,b,c){c=c||a;void 0===b&&
(b=!0);$rs.focusIn&&"function"==typeof $rs.focusIn&&($rs.focusIn(a,function(){$rs.addClass(c,"rsfocus");!0===b&&(u=a);rspkr.Common.dispatchEvent("onFocusIn",window,[a,c])}),$rs.focusOut(a,function(){$rs.removeClass(c,"rsfocus");rspkr.Common.dispatchEvent("onFocusOut",window,[a,c])}))},u=null,p=function(){u&&$rs.isVisible(u)&&(rspkr.log("[rspkr.ui.updateFocus] "+u.outerHTML),x(u))},x=function(a){$rs.focus&&"function"==typeof $rs.focus&&a&&$rs.focus(a)},v=function(a){if("iconon"==rspkr.st.get("hlicon")&&
!k){var b=g.push(new t)-1;g[b].id=b;g[b].show(a);k=!0}},r=function(a){"iconon"==rspkr.st.get("hlicon")&&k&&(g.pop().hide(),k=!1)},t=function(){var a=0,b=0,c=null,f=52,e=null,h=null,l=null,n=function(a){a=a||c;$rs.addClass(a,rspkr.ui.rsbtnClass+" rspopup");rspkr.cfg.item("general.useCompactPopupButton")&&$rs.addClass(a,"rscompact")},w=function(a){$rs.unregEvent(c,"mouseout",q);window.clearTimeout(e);var b,f=c.clientWidth+10,g;h=rspkr.ui.showPlayer(l,c,!0);g=h.getWidth();b=parseInt($rs.offset(c).left);
(b=rspkr.ui.viewport.width+$rs.scrollLeft(document)-b)<g&&(b=parseInt($rs.css(c,"left"))-(g-(f-10)),$rs.css(c,"left",b+"px"));k=!1;$rs.unregEvent(l,"click",w);$rs.regEvent(l,"click",function(a){m(a);return h.restart()});m(a);return!1},q=function(a){e||(e=window.setTimeout(function(){x()},rspkr.cfg.item("general.popupCloseTime")||2E3))},p=function(a){e&&(window.clearTimeout(e),e=null)},u=function(a,b){var e=document.body.getBoundingClientRect();$rs.css(c,{top:b-e.top+"px",left:a-e.left+"px",width:f+
"px"})},x=function(){$rs.css(c,{display:"none",top:0,left:0});p();g.splice(null,1);k=!1;c.parentElement.removeChild(c)};(function(){var a=rspkr.c.findFirstRSButton();c=document.createElement("div");c.id=rspkr.getID();c.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");n();l=$rs.findIn(c,".rsbtn_play");$rs.setAttr(l,"href",a?$rs.getAttr(a,"href"):null);(a=rspkr.cfg.item("general.popupHref"))&&$rs.setAttr(l,"href",a);var a=$rs.getAttr(l,"href").match(/lang=([^&;]*)/i).pop(),b=$rs.findIn($rs.get(c),
".rsbtn_play span.rsbtn_text span");b&&(b.textContent=b.innerText=rspkr.cfg.getPhrase("listen",a,"en_us"));$rs.setAttr(l,"title",rspkr.cfg.getPhrase("listentoselectedtext",a,"en_us"));$rs.regEvent(l,"click",w);document.body.appendChild(c)})();return{setPos:u,show:function(e){p(e);if(e&&"none"==$rs.css(c,"display")){var g=c.cloneNode(!0);g.id=rspkr.getID();$rs.css(g,{display:"block",position:"absolute",top:0,left:0});document.body.appendChild(g);f=$rs.outerWidth(g)+3;document.body.removeChild(g);g=
e.clientX||e.pageX||rspkr.ui.pointerX;e=e.clientY||e.pageY||rspkr.ui.pointerY;b=e>rspkr.ui.pointerY?e-$rs.scrollTop(document)+36>rspkr.ui.viewport.height-46?e-66:e+30:10>e-$rs.scrollTop(document)-66?e+30:e-51;a=10>g-$rs.scrollLeft(document)?g+10:g-$rs.scrollLeft(document)>rspkr.ui.viewport.width-(f+10)?rspkr.ui.viewport.width+$rs.scrollLeft(document)-(f+10):g+0;u(a,b)}$rs.regEvent(c,"mouseout",q);$rs.regEvent(c,"mouseover",p);q(null);n();$rs.css(c,"display","block")},hide:x,id:null}},y={update:function(b,
c,e){"hlspeed"===b&&c!==e&&(b=b.replace("hl",""),rspkr.c.converter[b]&&"function"==typeof rspkr.c.converter[b]&&(c=rspkr.c.converter[b](c)),rspkr.c.data[b]=c,a&&a.stop(),rspkr.pl.releaseAdapter())}},z=function(a,b,c,e,f,g){$rs.css(a,"background-color","rgb("+b+","+c+","+e+")");e<f?(e+=10,window.setTimeout(function(){z(a,b,c,e,f,g)},50)):g&&"function"===typeof g&&g.apply(a,[])},A=function(){return rspkr.XP?rspkr.XP:rspkr.HL};_expand=function(a){"string"==typeof a&&(a=$rs.get(a));$rs.isArray(a)||(a=
[a]);for(var b=0;b<a.length;b++)rspkr.ui.Player(a[b]).show(!0)};_animate=function(){var a=rs.cfg.item("ui.animate");if(a){var b,c=15,e=500;"object"==typeof a?(a.id&&(b=$rs.get(a.id)),a.count&&(c=a.count),a.interval&&(e=a.interval)):"string"===typeof a&&(b=$rs.get(a));if("boolean"===typeof a&&a||$rs.isArray(b)&&0==b.length||!b)b=$rs.get("."+rs.ui.rsbtnClass);$rs.isArray(b)||(b=[b]);var f=c,g=setInterval(function(){0==f&&($rs.removeClass(b,"rsanimate"),clearInterval(g));1==f--%2?$rs.addClass(b,"rsanimate"):
$rs.removeClass(b,"rsanimate")},e)}};return{meta:{revision:"DEV"},initrun:!1,init:function(){var a=rspkr.Common.addEvent;a("onAfterModsLoaded",f);a("onReady",n);a("onReady",c);a("onReady",_animate);a("onSelectedText",v);a("onDeselectedText",r);a("onSettingsChanged",y.update);a("onAfterSyncInit",p);this.initrun=!0;rspkr.Common.dispatchEvent("onUIInitialized");rspkr.log("[rspkr.ui] Initialized!")},addFocusHandler:function(a,b,c){q(a,b,c)},focus:function(a){x(a)},updateFocus:function(){p()},showOverlay:function(a,
b){w(a,b)},settings:y,rsbtnClass:"",addClickEvents:function(){n()},initGlobalCallbacks:function(){f()},showPopupIcon:function(a){v(a)},processDeferred:function(){c()},showPlayer:function(a,b,c){return h(a,b,c)},expand:function(a){_expand(a)},pointerX:0,pointerY:0,setPointerPos:function(a){a.pageX&&(rspkr.ui.pointerX=a.pageX);a.pageY&&(rspkr.ui.pointerY=a.pageY);a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageX&&(rspkr.ui.pointerX=a.originalEvent.touches[0].pageX);
a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageY&&(rspkr.ui.pointerY=a.originalEvent.touches[0].pageY);return!0},viewport:{width:$rs.width(window),height:$rs.height(window)},popups:g,hl:function(a,b){window.setTimeout(function(){z(a,255,255,100,255,b)},200)},scroll:{INTERVAL:null,STEPS:25,scrollToElm:function(a){$rs.isVisible(a)&&this.initScroll(a)},scrollToAnchor:function(a){for(var b=$rs.get("a"),c=null,e=0;e<b.length;e++){var f=b[e];if(f.name&&
f.name==a){c=f;break}}this.initScroll(c)},initScroll:function(a){if(a){for(var b=a.offsetTop,c=a;c.offsetParent&&c.offsetParent!=document.body;)c=c.offsetParent,b+=c.offsetTop;b-=50;rs.cfg.item("ui.autoscrollOffset")&&!isNaN(rs.cfg.item("ui.autoscrollOffset"))&&(b-=rs.cfg.item("ui.autoscrollOffset"));clearInterval(rspkr.u.scroll.INTERVAL);var c=rspkr.u.scroll.getCurrentYPos(),e=parseInt((b-c)/rspkr.u.scroll.STEPS);rspkr.u.scroll.INTERVAL=setInterval(function(){rspkr.u.scroll.scrollWindow(e,b,a)},
10)}else document.location.hash=a},getCurrentYPos:function(){return document.body&&document.body.scrollTop?document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:window.pageYOffset?window.pageYOffset:0},scrollWindow:function(a,b,c){var e=rspkr.u.scroll.getCurrentYPos(),f=e<b;window.scrollTo(0,e+a);a=rspkr.u.scroll.getCurrentYPos();if(f!=a<b||e==a)window.scrollTo(0,b),clearInterval(rspkr.u.scroll.INTERVAL),"string"==typeof c&&(location.hash=
c)}},activePlayer:a,getActivePlayer:function(){return a}}}();
ReadSpeaker.ui.Slider=function(){var a=this,b={handleClass:"",width:0,height:0,left:0,top:0,steps:-1,stepsize:-1,dir:"h",initval:-1,drop:null,start:null,dragging:null,click:null,labelDragHandle:"",labelStart:"",labelEnd:"",nudge:1},g={rsid:void 0,parent:void 0,ref:void 0},k=void 0,m=void 0,n=void 0,l=void 0,e=void 0,f=!1,c=0,h=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()};
this.initElement=function(a){if(!f){"string"==typeof a&&(a=document.getElementById(a));a.innerHTML+='<a href="javascript:void(0);" role="slider" class="keyLink" style="display:block; border:0;">&#160;</a>';var e=a.getElementsByTagName("a"),e=e[e.length-1],k=-1<b.steps?b.steps:100;e.relatedElement=a;$rs.setAttr(e,"title",b.labelDragHandle);try{$rs.setAttr(e,"aria-label",b.labelDragHandle),$rs.setAttr(e,"aria-orientation","h"==b.dir?"horizontal":"vertical"),$rs.setAttr(e,"aria-valuemin",0),$rs.setAttr(e,
"aria-valuemax",k),$rs.setAttr(e,"aria-valuenow",b.initval||0)}catch(l){}c=b.initval;$rs.regEvent(a,"mousedown",this.startDragMouse);$rs.regEvent(e,"click",function(a){h(a)});$rs.regEvent(e,"keyup",this.startDragKeys);$rs.regEvent(e,"dragstart",function(a){h(a)});$rs.regEvent(a,"touchstart",this.touchStart);$rs.regEvent(g.parent,"mousedown",this.mouseClick)}};this.mouseClick=function(c){if(!f&&!$rs.hasClass(g.ref,"dragged")){var e=a.findPos(c.target),h=c.clientX-(e.left-b.left);c=c.clientY-(e.top-
b.top);n=e.left;l=e.top;e=a.getCurrentVal({left:h,top:c});"function"==typeof b.click&&b.click(e,g);return!1}};this.findPos=function(a){var b=curTop=0;if(a.offsetParent){do b+=a.offsetLeft,curTop+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:curTop}}};this.startDragMouse=function(b){rspkr.log("[rspkr.ui.Slider] startDragMouse");if(!f){a.startDrag(this);var c=b||window.event;k=c.clientX;m=c.clientY;$rs.regEvent(document.body,"mousemove",a.dragMouse);$rs.regEvent(document.body,"mouseup",a.releaseElement)}h(b);
return!1};this.startDragKeys=function(b){rspkr.log("[rspkr.ui.Slider] startDragKeys "+(b||window.event).keyCode);a.startDrag(this.relatedElement);$rs.regEvent(document.body,"keydown",a.dragKeys);$rs.regEvent(document.body,"keypress",a.switchKeyEvents);$rs.addClass(this.relatedElement,"rskeycontrolled");h(b)};this.touchStart=function(b){b=b.originalEvent;rspkr.log("[rspkr.ui.Slider] touchStart");f||(a.startDrag(b.target),k=b.touches[0].pageX,m=b.touches[0].pageY,$rs.regEvent(b.target,"touchmove",a.touchMove),
$rs.regEvent(b.target,"touchend",a.releaseElement));return!1};this.startDrag=function(c){rspkr.log("[rspkr.ui.Slider] startDrag");e&&a.releaseElement();n=c.offsetLeft;l=c.offsetTop;e=c;$rs.addClass(e,"dragged");"function"==typeof b.start&&b.start(g)};this.dragMouse=function(b){b=b||window.event;a.setPosition(b.clientX-k,b.clientY-m);a.valueChanged=!0;return!1};this.touchMove=function(b){b=b.originalEvent?b.originalEvent:b;h(b);a.setPosition(b.touches[0].pageX-k,b.touches[0].pageY-m);a.valueChanged=
!0;return!1};this.dragKeys=function(e){switch((e||window.event).keyCode){case 37:case 63234:a.valueChanged=!0;c-=b.nudge;break;case 38:case 63232:a.valueChanged=!0;c+=b.nudge;break;case 39:case 63235:a.valueChanged=!0;c+=b.nudge;break;case 40:case 63233:a.valueChanged=!0;c-=b.nudge;break;case 13:case 27:return a.releaseElement(),!1;case 9:return a.releaseElement(),!0;default:return rspkr.log("[rspkr.ui.Slider] return TRUE"),!0}!0===a.valueChanged&&(rspkr.c.dispatchEvent("onUISliderMove"),"function"==
typeof b.dragging&&b.dragging(a.getCurrentVal({skipValueCalculation:!0}),g));h(e);rspkr.log("[rspkr.ui.Slider] ready to return!");return!1};this.setPosition=function(c,f){var h,k=!1;h=c;var m=n,v=b.left,r=b.width,t="left";"v"==b.dir&&(h=f,m=l,v=b.top,r=b.height,t="top");h=m+h;-1<b.stepsize&&((h+v)%b.stepsize?h=b.stepsize*Math.ceil(h/b.stepsize)+v:k=!0);h>r+v?h=r+v:h<v&&(h=v);k||(e.style[t]=h+"px","function"==typeof b.dragging&&b.dragging(a.getCurrentVal(),g))};this.switchKeyEvents=function(){$rs.unregEvent(document.body,
"keydown",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.regEvent(document.body,"keypress",a.dragKeys)};this.releaseElement=function(){rspkr.log("[rspkr.ui.Slider] releaseElement");$rs.unregEvent(document.body,"mousemove",a.dragMouse);$rs.unregEvent(document.body,"mouseup",a.releaseElement);$rs.unregEvent(document.body,"keypress",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.unregEvent(document.body,"keydown",a.dragKeys);$rs.unregEvent(e,"touchmove",
a.touchMove);$rs.unregEvent(e,"touchend",a.releaseElement);$rs.removeClass(e,"dragged");$rs.removeClass(e,"rskeycontrolled");$rs.removeClass(e,"rsmousecontrolled");var c=a.getCurrentVal();e=null;"function"==typeof b.drop&&!0===a.valueChanged&&b.drop(c,g);a.valueChanged=!1;rs.ui.getActivePlayer()&&rs.ui.getActivePlayer().setProgress();return!1};this.getCurrentVal=function(a){var e,f=b.width;e="left";var h=b.left;"v"==b.dir&&(f=b.height,e="top",h=b.top);var k=-1<b.steps?b.steps:100,f=-1<b.stepsize?
b.stepsize:f/k;a=a?a[e]:$rs.css(g.ref,e).replace(/px/i,"");pos=Math.round(a)-h;e=Math.round(pos/f);"v"==b.dir&&(e=k-e);rspkr.log("[rspkr.ui.Slider] currentval: "+e);return a&&a.skipValueCalculation||isNaN(e)?c=Math.max(Math.min(c,k),0):c=e};return{init:function(c,e){"string"==typeof c&&(c=document.getElementById(c));if(c){var f=c.id||"data-readspeaker-slider-id-"+Math.floor(2E4*Math.random());c.setAttribute&&c.setAttribute("data-readspeaker-slider-id-","data-readspeaker-slider-parent-"+f);var h={width:function(){return $rs.width(c)},
height:function(){return $rs.height(c)}};if("object"==typeof e)for(var k in e)e.hasOwnProperty(k)&&void 0!==b[k]&&(b[k]=e[k]);k=!1;var l;"rsbtn_volume_slider"===c.className&&"jquery"===rspkr.l.f.currentLib()&&1.5>parseFloat(jQuery.fn.jquery)&&(l=c.parentNode.style.display,c.parentNode.style.display="block",k=!0);b.width=h.width();b.height=h.height();k&&(c.parentNode.style.display=l);-1<b.steps&&(b.stepsize=("h"==b.dir?b.width:b.height)/b.steps);h=document.createElement("span");h.setAttribute("data-readspeaker-slider-id-",
f);h.className=b.handleClass||"rsbtn_progress_handle rsimg";c.appendChild(h);g.rsid=f;g.parent=c;g.ref=h;f=$rs.css(h,"left");null!==f&&(b.left=parseInt(f.replace(/px/i,"")));f=$rs.css(h,"top");null!==f&&(b.top=parseInt(f.replace(/px/i,"")));-1<b.initval&&this.jumpTo(b.initval);b.labelStart&&(f=document.createElement("span"),f.className="slider-label-start",f.innerHTML=b.labelStart,c.appendChild(f));b.labelEnd&&(f=document.createElement("span"),f.className="slider-label-end",f.innerHTML=b.labelEnd,
c.appendChild(f));a.initElement(h)}},jumpTo:function(a){if(isNaN(a))return!1;var c=101,e=a;-1<b.steps&&(a=Math.round(a),c=b.steps+1);if(-1<a&&a<c){var f=b.width,h=b.left,k="left";"v"==b.dir&&(f=b.height,h=b.top,k="top",a=c-1-a);g.ref.style[k]=f/(c-1)*a+h+"px";$rs.setAttr($rs.findIn(g.ref,"a.keyLink"),"aria-valuenow",e)}},setCurrentValue:function(a){c=a},getInstance:function(){return g},getContainer:function(){return g.parent},releaseElement:function(){a.releaseElement()},startDragKeys:function(b,
c){a.startDragKeys.call(b,c)},disabled:function(){if(arguments)f=arguments[0];else return f}}};
ReadSpeaker.ui.Player=function(a){var b=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},g=function(b){b=b||a;b=$rs.clone(b,!0,!0);var c;b.id=rspkr.getID();document.body.appendChild(b);$rs.css(b,{position:"absolute",top:"0",left:"0",display:"block",width:"auto"});$rs.css(b,"float","none");$rs.addClass(b,"rsexpanded");c=$rs.outerWidth(b)+3;b.style.display="none";
document.body.removeChild(b);return c},k=rspkr.getID(),m=this,n=[],l=0,e=!1,f=null,c=!1,h={_play:null,_pause:null,_stop:null,_vol:null,_settings:null,_dl:null,_closer:null,_powered:null,_get:function(b,c){var e;b="_"+b;e=a?this[b]&&0<this[b].length?this[b]:this[b]=$rs.findIn(a,c):null;return e==[]?null:e},play:function(){return this._get("play",".rsbtn_play")},pause:function(){return this._get("pause",".rsbtn_pause")},stop:function(){return this._get("stop",".rsbtn_stop")},vol:function(){return this._get("vol",
".rsbtn_volume")},settings:function(){return this._get("settings",".rsbtn_settings")},dl:function(){return this._get("dl",".rsbtn_dl")},pin:function(){return this._get("pin",".rsbtn_pin")},powered:function(){return this._get("powered",".rsbtn_powered")},closer:function(){return this._get("closer",".rsbtn_closer")},nosound:function(){return this._get("nosound",".rsbtn_nosound")},setPlayPause:function(a){rspkr.log("[rspkr.ui.Player.setPlayPause("+a+")]");a=a?$rs.getAttr(this.pause(),"data-rsphrase-play"):
$rs.getAttr(this.pause(),"data-rsphrase-pause");$rs.setAttr(this.pause(),"title",rspkr.c.decodeEntities(a));$rs.findIn(this.pause(),".rsbtn_btnlabel").innerHTML=a}},w=!1,q=[],u=function(){var b=null,b=rspkr.cfg,c=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang"));if(0==$rs.findIn(a,".rsbtn_exp").length){var e=$rs.hasClass(a,"rspopup")?b.item("ui.popupplayer"):b.item("ui.player"),b=document.createElement("div");b.className="rsbtn_exp rsimg rspart";b.innerHTML+=e.join("\n");a.appendChild(b)}b=h.pin();
e="Explorer"==rspkr.c.data.browser.name&&8>rspkr.c.data.browser.version;$rs.isArray(b)&&0==b.length&&(b=void 0);b&&!e&&rspkr.cfg.item("ui.usePin")?$rs.removeClass(b,"turnedOff"):b&&b.parentElement.removeChild(b);if(c){b=function(a,b){var c=$rs.findIn(a,".rsbtn_btnlabel");$rs.isArray(c)||(c=[c]);0<c.length&&(c[0].innerHTML=b)};h.pause()&&($rs.setAttr(h.pause(),"data-rsphrase-pause",c.pause),$rs.setAttr(h.pause(),"data-rsphrase-play",c.play),$rs.setAttr(h.pause(),"title",rspkr.c.decodeEntities(c.pause)),
b(h.pause(),rspkr.c.decodeEntities(c.pause)));h.stop()&&($rs.setAttr(h.stop(),"title",rspkr.c.decodeEntities(c.stop)),b(h.stop(),rspkr.c.decodeEntities(c.stop)));h.vol()&&($rs.setAttr(h.vol(),"title",rspkr.c.decodeEntities(c.volume)),b(h.vol(),rspkr.c.decodeEntities(c.volume)));h.settings()&&($rs.setAttr(h.settings(),"title",rspkr.c.decodeEntities(c.settings)),b(h.settings(),rspkr.c.decodeEntities(c.settings)));h.dl()&&($rs.setAttr(h.dl(),"title",rspkr.c.decodeEntities(c.download)),b(h.dl(),rspkr.c.decodeEntities(c.download)));
if(h.powered()){var e=$rs.findIn(h.powered(),".rsbtn_btnlabel"),f=c.speechenabled.match(/.*href="([^"]*)"/i).pop(),g=c.newwindow,k=document.createElement("p");k.innerHTML=c.speechenabled;g=(k.innerText||k.textContent)+(g?" ("+g+")":"");e&&(e.innerHTML=c.speechenabled);$rs.setAttr(h.powered(),"title",g);$rs.setAttr(h.powered(),"data-readspeaker-href",f);e=$rs.getAttr(h.powered(),"data-rsevent-id");(!e||rs.l.f.eq.store[e]&&!rs.l.f.eq.store[e].click)&&$rs.regEvent(h.powered(),"click",function(){window.open($rs.getAttr(this,
"data-readspeaker-href"))})}h.closer()&&($rs.setAttr(h.closer(),"title",rspkr.c.decodeEntities(c.closeplayer)),b(h.closer(),rspkr.c.decodeEntities(c.closeplayer)))}c=rspkr.c.data.browser;/safari/i.test(c.name)&&/iphone|ipad|ios/i.test(c.OS)||$rs.addClass(a,"rs-no-touch")},p={play:function(){rspkr.c.dispatchEvent("onUIBeforePlay");rspkr.log("[rspkr.ui.handlers.play]");q.progress&&q.progress.disabled(!1);p.setStateClass(a,"rsplaying");rspkr.basicMode&&p.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsplaying");
$rs.addClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");h.setPlayPause(!1);if(rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().getContainer()==a)rspkr.pl.play(),c&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,v,m]),rspkr.c.addEvent("onBeforeSyncInit",function(){c=!0;rspkr.pl.getProgress.apply(rspkr.pl,[!0,v,m])}),"flash"!==rspkr.pl.adapter||rspkr.displog.onVolumeAdjusted||rspkr.pl.setVolume(parseInt(rspkr.st.get("hlvol")||"100")),rspkr.c.dispatchEvent("onUIAfterPlay"),rspkr.cfg.execCallback("cb.ui.play",
a);else{rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().close();var b=$rs.findIn(a,".rsbtn_play");window.readpage(b)}},pause:function(){rspkr.log("[rspkr.ui.handlers.pause]");p.setStateClass(a,"rspaused");rspkr.basicMode&&p.setStateClass($rs.findIn(a,".rsbtn_exp"),"rspaused");h.setPlayPause(!0);rspkr.pl.pause();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIPause");rspkr.cfg.execCallback("cb.ui.pause",a);rspkr.log("ReadSpeaker.ui.pause")},stop:function(){rspkr.log("[rspkr.ui.handlers.stop]");
q.progress&&q.progress.disabled(!0);p.setStateClass(a,"rsstopped");$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");rspkr.basicMode&&p.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped");h.setPlayPause(!0);$rs.setAttr(a,"data-readspeaker-current",0);q.progress&&(q.progress.jumpTo(0),x(0));rspkr.pl.stop();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIStop",a);rspkr.cfg.execCallback("cb.ui.stop",a);document.getElementById("rslightbox_contentcontainer")&&$rs.isVisible(document.getElementById("rslightbox_contentcontainer"))||
h.pause().focus();rspkr.HL.chunking&&1<rspkr.HL.chunking.currentChunkNumber&&(rspkr.HL.chunking.destroy(),rspkr.pl.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter());rspkr.log("ReadSpeaker.ui.stop")},setStateClass:function(a,b){a&&($rs.removeClass(a,"rspaused rsstopped rsplaying"),$rs.addClass(a,b))},vol:function(b){var c=$rs.findIn(a,".rsbtn_volume_container"),e=$rs.findIn(a,".rsbtn_volume");b=b.originalEvent;var f=function(a){var b=a.originalEvent,b=$rs.closest(b.srcElement||b.originalTarget,
".rsbtn_volume_container");if("click"===a.type){if(void 0===b||$rs.isArray(b)&&!b.length)$rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f)}else"keyup"===a.type&&27===a.keyCode&&($rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f))};$rs.css(c,"left",e.offsetLeft+"px");$rs.css(c,"display","none"==$rs.css(c,"display")?"block":"none");"block"===$rs.css(c,"display")?($rs.regEvent(document.body,
"click",f),$rs.regEvent(document.body,"keyup",f)):($rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f));b&&b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0;e={keyCode:13};b=$rs.findIn(c,".keyLink");try{q.vol.startDragKeys(b,e)}catch(g){rspkr.log("[rspkr.ui.handlers.vol] Error accessing object _sliders['vol']")}return!1},settings:function(){$rs.hasClass(a,"rsplaying")&&this.pause();rspkr.ui.Lightbox.show(rspkr.st.getHTML(),rspkr.st.getButtons(),!0,function(a){var b=
$rs.get("rslightbox_closer"),c=function(){document.removeEventListener?b.removeEventListener("click",c,!1):document.detachEvent&&document.detachEvent("onclick",c);rspkr.c.dispatchEvent("onSettingsClosed",window,[])};$rs.regEvent(b,"click",c);rspkr.ui.addClickEvents();rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",a)})},close:function(b){p.pin(!0);b=b||!1;var c=rspkr.pl,e=!1;rspkr.HL.chunking&&rspkr.HL.chunking.destroy();b||rspkr.cfg.execCallback("cb.ui.beforeclose",
a);c.hasOwnProperty("getProgress")&&rspkr.pl.getProgress(!1);c.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter();$rs.setAttr(a,"data-readspeaker-current",0);q.progress&&(q.progress.jumpTo(0),x(0));$rs.removeClass(a,"rsstopped rsplaying rspaused rsexpanded");if(rspkr.basicMode){var f;(f=$rs.findIn(a,".rsbtn_play"))&&$rs.removeClass(f,"rsexpanded")}$rs.hasClass(a,"rsfloating")&&($rs.removeClass(a,rspkr.ui.rsbtnClass),rspkr.basicMode&&($rs.removeClass(a,"rsvisible"),$rs.addClass(a,"rshidden")));
h.setPlayPause(!0);$rs.hasClass(a,"rspopup")&&(e=!0,$rs.removeClass(a,"rspopup"),$rs.css(a,"display","none"),a.parentNode.removeChild(a));$rs.css(a,"width","auto");delete rspkr.displog.onVolumeAdjusted;b||(rspkr.c.dispatchEvent("onUIClosePlayer",a,["userclick"]),rspkr.cfg.execCallback("cb.ui.close",a),rspkr.log("ReadSpeaker.ui.close: "+a));b||!1!==e||rspkr.ui.focus($rs.findIn($rs.get(a),".rsbtn_play"))},dl:function(c){$rs.hasClass(a,"rsplaying")&&this.pause();var e=(c=$rs.getAttr($rs.findIn(a,".rsbtn_play"),
"href"))?rspkr.c.data.getSaveData("dialog",c):rspkr.c.data.getSaveData("dialog"),f=!1;rspkr.log("[rspkr.ui.handlers.dl] Savelink: "+e);rspkr.u.Lightbox.show(this.getDlDialog(),this.getDlButtons(),!0,function(){var a=$rs.get("#rsdl_button_accept"),c=$rs.get("#rsdl_button_decline");a&&$rs.regEvent(a,"click",function(b){rspkr.u.Lightbox.hide(b);f="iOS"!==rspkr.c.data.browser.OS&&0<rspkr.c.data.selectedHTML.length?!0:"iOS"!==rspkr.c.data.browser.OS&&!0===rspkr.cfg.item("general.usePost")?!0:!1;if(!0===
f){b=null;if(document.getElementById("dliframe"))b=document.getElementById("dliframe");else{if(document.selection)try{b=document.createElement('<iframe name="dliframe">')}catch(c){b=document.createElement("iframe")}else b=document.createElement("iframe");b.name="dliframe";b.setAttribute("id","dliframe");b.setAttribute("style","display: none; position: absolute;");b.style.display="none";var g=document.getElementsByTagName("body"),h=null;0<g.length&&(h=g.item(0));if(h)h.appendChild(b);else return}b.src=
e;return!1}$rs.setAttr(a,"href",e);return!0});c&&($rs.regEvent(c,"click",function(a){b(a);rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(c)},200));rspkr.c.dispatchEvent("onDownloadLoaded",window,[])})},pin:function(b,c){var e=a.id+"_pinnedHome",f=document.getElementById(e);c=c?!0:!1;if(!$rs.hasClass(h.pin(),"pinned")&&!b){if($rs.addClass(h.pin(),"pinned"),!f){var g=function(a,b){return window.getComputedStyle?window.getComputedStyle(a)[b]:a.currentStyle?a.currentStyle[b]:a.style[b]},
f=$rs.clone(a,!1,!0),k=a.offsetLeft,l=a.offsetTop;if(!c){f.style.width=g(a,"width").replace(/[^-\d\.]/g,"")-2+"px";f.style.height=g(a,"height").replace(/[^-\d\.]/g,"")-2+"px";for(var n="position left right top bottom margin-left margin-right margin-top margin-bottom".split(" "),m=0,q;q=n[m];m++){var p=$rs.css(a,q);$rs.setAttr(a,"data-css-"+q,p);p=g(a,q);"auto"!=p&&(f.style[q]=p)}f.className="rsbtn_pinnedHome rsbtn";for(f.id=e;f.hasChildNodes();)f.removeChild(f.lastChild);a.parentElement.insertBefore(f,
a)}a.style.position="fixed";a.style.top=l-$rs.scrollTop(document)+"px";a.style.left=k-$rs.scrollLeft(document)+"px"}}else if($rs.hasClass(h.pin(),"pinned")||b)if($rs.removeClass(h.pin(),"pinned"),f)for(f.parentNode.removeChild(f),n="position left right top bottom margin-left margin-right margin-top margin-bottom".split(" "),m=0;q=n[m];m++)p=$rs.getAttr(a,"data-css-"+q),$rs.css(a,q,p)},getDlDialog:function(){var a=rspkr.cfg.item("ui.dldialog").join("\n"),b={};b.rsTERMS_OF_USE_HEADINGrs=rspkr.cfg.getPhrase("touheading");
b.rsTERMS_OF_USE_BODYrs=rspkr.cfg.getPhrase("toubody");return rspkr.st.r().replaceTokens(a,b)},getDlButtons:function(){var a=rspkr.cfg.item("ui.dlbuttons").join("\n"),b={};b.rsTERMS_OF_USE_ACCEPTrs=rspkr.cfg.getPhrase("touaccept");b.rsTERMS_OF_USE_DECLINErs=rspkr.cfg.getPhrase("toudecline");return rspkr.st.r().replaceTokens(a,b)},nosound:function(){var a=rspkr.c.data.getSaveData("link");$rs.setAttr(h.nosound(),"href",a);return!0}},x=function(b){b=100<b?100:b;var c=$rs.findIn(a,".rsbtn_progress_played");
"object"===typeof c&&$rs.css(c,"width",b+"%");rspkr.cfg.execCallback("cb.ui.progresschanged",a,[b])},v=function(b){if(b.length){var c=parseInt(b[0]);b=parseInt(b[1]);var e=0==b?0:Math.round(c/b*100),f=$rs.findIn(a,".rsbtn_current_time"),g=$rs.findIn(a,".rsbtn_total_time"),h,k;q.progress&&(q.progress.setCurrentValue(e),w||(q.progress.jumpTo(e),x(e),f&&(f.innerHTML=h=r(c)),g&&(g.innerHTML=k=r(b)),rspkr.cfg.execCallback("cb.ui.timeupdated",a,[h,k])));rspkr.log("[rspkr.player.updateProgress] current time: "+
c+" total time: "+b);$rs.setAttr(a,"data-readspeaker-current",c);$rs.setAttr(a,"data-readspeaker-buffered",b);0<c&&$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading")}},r=function(a){a/=1E3;var b=parseInt(a%60),c=parseInt(a/60%60);a=parseInt(a/60/60%60);return(10>a?"0"+a:a.toString())+":"+(10>c?"0"+c:c.toString())+":"+(10>b?"0"+b:b.toString())},t=function(){w=!0},y=function(b,c){rspkr.log("_dropProgress ("+b+")",5);if(b){var e=b/100*$rs.getAttr(a,"data-readspeaker-buffered")/1E3;
rspkr.pl.setProgress(e)}w=!1},z=function(a){y(a)},A=function(b,c){rspkr.log("_dropVolume, "+b,5);b=0>b?0:20*b;q.vol&&q.vol.jumpTo(b/20);rspkr.pl.setVolume(b);rspkr.st.set("hlvol",b);rspkr.cfg.execCallback("cb.ui.volumechanged",a,[b]);return!1},B=function(b,c){if("keyLink"===b.className){var e="";$rs.hasClass(c,"rsbtn_volume_handle")?e="vol":$rs.hasClass(c,"rsbtn_progress_handle")&&(e="progress");var f={keyCode:13};q[e].startDragKeys(b,f)}else $rs.hasClass(c,"rsbtn_volume")&&(f={keyCode:13},e=$rs.findIn(a,
".rsbtn_volume_container"),e=$rs.findIn(e,".keyLink"),q.vol.startDragKeys(e,f))},C=function(a,b){if("keyLink"===a.className){var c="";$rs.hasClass(b,"rsbtn_volume_handle")?c="vol":$rs.hasClass(b,"rsbtn_progress_handle")&&(c="progress");q[c].releaseElement();w=!1}};return{init:function(){n.push([this.show,[]])},initVolume:function(){if(!$rs.isArray($rs.findIn($rs.get(a),".rsbtn_volume_slider"))){var b=rspkr.cfg,c=rspkr.st.get("hlvol")||"100",c=parseInt(c)/100*5;q.vol=new rspkr.ui.Slider;q.vol.init($rs.findIn(a,
".rsbtn_volume_slider"),{handleClass:b.item("ui.volumeHandleClass")||"rsbtn_volume_handle rsimg",dir:b.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:c,dragging:A,click:A,labelDragHandle:b.getPhrase("slidervolumedesc")});b=$rs.findIn($rs.get(a),".rsbtn_volume_handle a");ui.addFocusHandler(b,!1,b.parentNode)}},show:function(c){c=c?!0:!1;var f=$rs.hasClass(a,"rsexpanded");$rs.rsid(a);a.id=k=a.id||rspkr.getID();ui=rspkr.ui;$rs.hasClass(a,rspkr.ui.rsbtnClass)||$rs.addClass(a,rspkr.ui.rsbtnClass);u();
var n=$rs.findIn(a,".rsbtn_status_overlay");$rs.isArray(n)||$rs.css(n,"display","none");"fallback"===rspkr.pl.adapter&&(rspkr.ui.showOverlay("nosound",a),$rs.addClass(a,"rsstopped"));$rs.addClass(a,"rsexpanded");if(rspkr.basicMode){var m;(m=$rs.findIn(a,".rsbtn_play"))&&$rs.addClass(m,"rsexpanded")}e||f||(h.stop()&&($rs.regEvent(h.stop(),"click",function(a){b(a);p.stop()}),ui.addFocusHandler(h.stop())),h.pause()&&($rs.regEvent(h.pause(),"click",function(c){b(c);$rs.hasClass(a,"rsplaying")?p.pause():
($rs.hasClass(a,"rsstopped")||$rs.hasClass(a,"rspaused"))&&p.play()}),ui.addFocusHandler(h.pause())),h.closer()&&($rs.regEvent(h.closer(),"click",function(a){b(a);p.close()}),ui.addFocusHandler(h.closer())),h.vol()&&($rs.regEvent(h.vol(),"click",function(a){b(a);p.vol(a)}),ui.addFocusHandler(h.vol())),h.dl()&&($rs.regEvent(h.dl(),"click",function(a){b(a);return p.dl(a)}),ui.addFocusHandler(h.dl())),h.settings()&&($rs.regEvent(h.settings(),"click",function(a){b(a);p.settings()}),ui.addFocusHandler(h.settings())),
h.pin()&&($rs.regEvent(h.pin(),"click",function(a){b(a);p.pin()}),ui.addFocusHandler(h.pin())),m=rspkr.cfg,$rs.setAttr(a,"data-readspeaker-current",0),$rs.setAttr(a,"data-readspeaker-buffered",0),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_progress_container"))||(q.progress=new rspkr.ui.Slider,q.progress.init($rs.findIn($rs.get(a),".rsbtn_progress_container"),{handleClass:m.item("ui.progressHandleClass")||"rsbtn_progress_handle rsimg",dir:m.item("ui.progressDir")||"h",nudge:5,start:t,dragging:y,click:z,
labelDragHandle:m.getPhrase("sliderseek")}),f=$rs.findIn($rs.get(a),".rsbtn_progress_handle a"),ui.addFocusHandler(f,!1,f.parentNode)),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_volume_slider"))||(f=rspkr.st.get("hlvol")||"100",f=parseInt(f)/100*5,q.vol=new rspkr.ui.Slider,q.vol.init($rs.findIn(a,".rsbtn_volume_slider"),{handleClass:m.item("ui.volumeHandleClass")||"rsbtn_volume_handle rsimg",dir:m.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:f,dragging:A,click:A,labelDragHandle:m.getPhrase("slidervolumedesc")}),
f=$rs.findIn($rs.get(a),".rsbtn_volume_handle a"),ui.addFocusHandler(f,!1,f.parentNode)),rspkr.Common.addEvent("onFocusIn",B),rspkr.Common.addEvent("onFocusOut",C),rspkr.cfg.execCallback("cb.ui.open",a),e=!0);$rs.findIn(a,".rsbtn_powered")&&(m=$rs.findIn(a,".rsbtn_powered .rsbtn_btnlabel a"))&&((/Chrome|Safari|Opera/gi.test(rs.c.data.browser.name)||/Explorer/gi.test(rs.c.data.browser.name)&&8<=rs.c.data.browser.version)&&$rs.regEvent(m,"click",function(a){b(a)}),m.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>');
"0"!=$rs.getAttr(a,"data-readspeaker-current")&&(rspkr.pl.releaseAdapter(),$rs.setAttr(a,"data-readspeaker-current",0));"fallback"===rspkr.pl.adapter||c?(q.progress&&q.progress.disabled(!0),p.setStateClass(a,"rsstopped"),$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading"),rspkr.basicMode&&p.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped")):(p.play(),rspkr.ui.focus(h.pause()));l=g(a);isNaN(l)||$rs.css(a,"width",l+(/[Ee]xplorer/.test(ReadSpeaker.c.data.browser.name)?1:0)+"px");
!$rs.hasClass(a,"rspopup")||rspkr.cfg.item("ui.pinnedPopup")||rspkr.basicMode||p.pin(!1,!0)},close:function(a){p.close(a)},stop:function(){p.stop()},nosound:function(){return p.nosound()},pause:function(){p.pause()},play:function(){p.play()},dl:function(a){p.dl(a)},settings:function(){p.settings()},vol:function(a){p.vol(a)},pin:function(a,b){p.pin(a,b)},restart:function(){rspkr.log("[rspkr.ui.restart]");p.stop();window.setTimeout(function(){p.play()},500);return!1},updateProgress:function(a){v(a)},
setProgress:function(a){y(a)},getContainer:function(){return a},getID:function(){return k},getWidth:function(){return l},setHref:function(a){f=a},getHref:function(){return f}}};
ReadSpeaker.ui.Lightbox=function(){var a=null,b=null,g=null,k=null,m=null,n=null,l,e=[],f=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},c=function(){var a=$rs.css(n,"display");$rs.css(n,"display","none");var b=$rs.height(window),c=$rs.height(document),e=parseInt($rs.css(document.documentElement,"width")),f=$rs.width(document),g=$rs.absOffset(document.body),k=
0,l=0;isNaN(e)&&(e=$rs.width(window));g.left&&(l=g.left);g.top&&(k=g.top);$rs.css(m,{width:(f>e?f:e)+"px",height:(c>b?c:b)+"px",top:"-"+Math.abs(k)+"px",left:"-"+Math.abs(l)+"px"});$rs.css(n,"display",a);h()},h=function(){var a=$rs.outerWidth(n),b=$rs.outerHeight(n),c=$rs.width(window),e=$rs.height(window),b=l+80+50<e?l+80:e-50;n.style.height=b+"px";$rs.get("#rslightbox_content").style.height=b-80+"px";b>e?(n.style.top=$rs.scrollTop(document)+"px",n.style.marginTop="10px"):(n.style.top=e/2+"px",n.style.marginTop=
-(b/2-$rs.scrollTop(document))+"px");a>c?(n.style.left=$rs.scrollLeft(document)+"px",n.style.marginLeft="0"):(n.style.left="50%",n.style.marginLeft=-(a/2-$rs.scrollLeft(document))+"px")},w=function(a){27===a.keyCode&&rspkr.ui.Lightbox.hide()};return{init:function(){var c=rspkr.pub.Config;a=c.item("ui.overlay.overlayStyles");b=c.item("ui.overlay.contentStyles");g=c.item("ui.overlay.contentTemplate");document.querySelectorAll||(d=document,s=d.createStyleSheet(),d.querySelectorAll=function(a,b,c,e,f){f=
d.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(c=a.length;c--;){s.addRule(a[c],"k:v");for(e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);s.removeRule(0)}return b});rspkr.log("[rspkr.ui.Lightbox] Heartbeat!")},show:function(h,u,p,x,v){for(var r=0,t=document.body.getElementsByTagName("*"),y;y=t[r];r++)-1!=y.tabIndex&&(e.push([y,y.tabIndex]),y.tabIndex=-1);if("Explorer"!=rs.c.data.browser.name||6!=rs.c.data.browser.version)for(y=document.querySelectorAll("body > *"),r=0;t=y[r];r++)if("rslightbox_overlay"!=
t.id&&"rslightbox_contentcontainer"!=t.id&&"script"!=t.tagName.toLowerCase()){var z=t.getAttribute("aria-hidden");z&&t.setAttribute("data-original-aria-hidden",z);t.setAttribute("aria-hidden","true")}h=h||"";p=p||!1;m?(m.style.display="",n.style.display=""):(m=document.createElement("div"),m.id="rslightbox_overlay",n=document.createElement("div"),n.id="rslightbox_contentcontainer",n.innerHTML=rspkr.st.r().replaceTokens(g.join("\n"),{rsLIGHTBOX_CLOSE_LABELrs:rspkr.cfg.getPhrase("close")}),$rs.setAttr(m,
"style",a.join(";")),$rs.setAttr(n,"style",b.join(";")),document.body.appendChild(m),document.body.appendChild(n),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.changed.addButtonEvents,context:rspkr.st.r().handlers.changed,params:[this]}));r=$rs.get("rslightbox_closer");rspkr.ui.addFocusHandler(r,!1);$rs.regEvent(r,"click",function(a){f(a);rspkr.ui.Lightbox.hide(a)});$rs.regEvent(m,"click",rspkr.ui.Lightbox.hide);$rs.regEvent(document.body,"keyup",w);(t=document.documentElement)&&document.all&&
(t.style.overflowX=t.style.overflowY="hidden");if(h!=k||p)p=rspkr.cfg.getPhrase("close"),$rs.setAttr(r,"title",p),$rs.findIn(r,".rsbtn_btnlabel").innerHTML=p,$rs.get("#rslightbox_content").innerHTML="",$rs.css("#rslightbox_content","height","auto"),/^http/i.test(h)?$rs.findIn("#rslightbox_content","iframe").length||(p=document.createElement("iframe"),p.src=h,p.className="rslightbox-iframe",void 0===v&&(v=2E3),$rs.get("#rslightbox_content").appendChild(p)):"<"==h.substr(0,1)&&($rs.get("#rslightbox_content").innerHTML=
h),$rs.get("#rslightbox_buttons").innerHTML=u,k=h,"ar_ar"==rs.c.data.params.lang&&(-1==n.className.indexOf("rtl")&&(n.className=(n.className+" rtl").replace(/^\s+|\s+$/g,"")),$rs.setAttr($rs.findIn(n,"legend"),"align","right"));l=void 0===v||isNaN(v)?rspkr.basicMode?$rs.get("#rslightbox_content").scrollHeight:$rs.get("#rslightbox_content").clientHeight:v;h=$rs.findIn("#rslightbox_content",".rsform-row");for(r=0;r<h.length;r++)for(u=$rs.findIn(h[r],"input, a, select"),$rs.isArray(u)||(u=[u]),t=0;t<
u.length;t++)rspkr.ui.addFocusHandler(u[t],!1,h[r]);var A=$rs.findIn("#rslightbox_buttons",".rssettings-button-close");rspkr.ui.addFocusHandler(A,!1);$rs.regEvent(A,"click",function(a){f(a)});(h=$rs.findIn("#rsform_wrapper",".rssettings-button-gotobottom"))&&!$rs.isArray(h)&&rspkr.ui.addFocusHandler(h,!1);(h=$rs.findIn("#rslightbox_buttons",".rssettings-button-gototop"))&&!$rs.isArray(h)&&rspkr.ui.addFocusHandler(h,!1);var B=$rs.findIn("#rslightbox_content","input");$rs.isArray(B)&&0<B.length?setTimeout(function(){rspkr.ui.focus(B[0]);
rspkr.Common.addEvent("onFocusIn",function(a,b){a.className&&$rs.hasClass(a,"rssettings-button-gototop")?rspkr.ui.focus(B[0]):a.className&&$rs.hasClass(a,"rssettings-button-gotobottom")&&rspkr.ui.focus(A)})},200):$rs.isArray(B)||setTimeout(function(){rspkr.ui.focus(B)},200);c();$rs.regEvent(window.document.documentElement,"resize",c);"function"==typeof x&&x.apply(this,[n])},hide:function(a){for(;0<e.length;){var b=e.pop();b[0].tabIndex=b[1]}if("Explorer"!=rs.c.data.browser.name||6!=rs.c.data.browser.version){a=
document.querySelectorAll("body > *");for(var b=0,g;g=a[b];b++){var h=g.getAttribute("data-original-aria-hidden");h?(g.setAttribute("aria-hidden",h),g.removeAttribute("data-original-aria-hidden")):g.removeAttribute("aria-hidden")}}f(a);m.style.display="none";n.style.display="none";$rs.unregEvent(window,"resize",c);$rs.unregEvent($rs.get("#rslightbox_closer"),"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(m,"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(document.body,"keyup",w);(a=document.documentElement)&&
document.all&&(a.style.overflowX=a.style.overflowY="auto");rspkr.ui.updateFocus();rspkr.c.dispatchEvent("onSettingsClosed",window,[])},reposition:h}}();
ReadSpeaker.q(function(){ReadSpeaker.HL.customHL=function(){var a="Explorer"==ReadSpeaker.c.data.browser.name&&8>ReadSpeaker.c.data.browser.version,b=void 0,g=function(e){b||(b=document.createElement("div"),b.id="rs_enlargeHL_box",a&&(b.className="rs_enlargeHL_legacy"),k(),document.body.appendChild(b));b.style.display="block"},k=function(){b&&(b.style.backgroundColor=ReadSpeaker.Common.Settings.get("hlsent"),b.style.color=ReadSpeaker.Common.Settings.get("hltext"))},m=function(a,c){var e=a.text?a.text:
a.innerHTML;if(/\S/.test(e)){ReadSpeaker.log("_sentHL ("+c+"): "+e,5);g();b.innerHTML=1==c?b.innerHTML+e:e;for(var e=b.getElementsByTagName(ReadSpeaker.Common.data.browser.syncContainer),k=0;k<e.length;k++)/^custom_/.test(e[k].id)||(e[k].id="custom_"+e[k].id)}},n=function(a,c){var e=a.text?a.text:a.innerHTML;if(/\S/.test(e)){ReadSpeaker.log("_wordHL ("+c+"): "+e,5);g();1!=c&&$rs.removeClass($rs.findIn(b,".sync_word_highlighted"),"sync_word_highlighted");var k=$rs.findIn(b,"#custom_"+a.id);if($rs.isArray(k))if(k=
a,a.innerHTML){for(;k.parentNode;){if(/\bsync_sent|ffsent/.test(k.parentNode.className)){ReadSpeaker.log("---\x3e Remitting to _sentHL",5);m(k.parentNode);n(a,c);return}k=k.parentNode}b.innerHTML=a.innerHTML;$rs.findIn(b,a.id).id="custom_"+a.id;n(a,c)}else b.innerHTML=e;else $rs.addClass(k,"sync_word_highlighted")}},l=function(){b&&(b.style.display="none",b.innerHTML="")};ReadSpeaker.c.addEvent("onSettingsChanged",function(){k();"enlargeoff"===rs.st.get("enlarge")&&l()});var e=rs.cfg.getSettingsConf();
e.highlighting&&e.highlighting.items&&(e.highlighting.items.enlarge={phrase:"ph_hlenlarge",type:"radio",info:"ph_hlenlargeinfo",options:[{value:"enlargeon",phrase:"ph_on"},{value:"enlargeoff",phrase:"ph_off"}]});return{active:function(){return"enlargeon"===ReadSpeaker.st.get("enlarge")},sentHL:m,wordHL:n,cleanUp:l}}()});
ReadSpeaker.q(function(){var a={en_us:{hlenlarge:"Enhanced text visibility",hlenlargeinfo:"Displays the current sentence at the bottom of the page, with a larger font size and simultaneous text highlighting."},en_uk:{hlenlarge:"Enhanced text visibility",hlenlargeinfo:"Displays the current sentence at the bottom of the page, with a larger font size and simultaneous text highlighting."},ar_ar:{hlenlarge:decodeURIComponent("%D8%AA%D8%B9%D8%B2%D9%8A%D8%B2%20%D8%B1%D8%A4%D9%8A%D8%A9%20%D8%A7%D9%84%D9%86%D8%B5"),
hlenlargeinfo:decodeURIComponent("%D9%8A%D8%B9%D8%B1%D8%B6%20%D8%A7%D9%84%D8%AC%D9%85%D9%84%D8%A9%20%D8%A7%D9%84%D8%AD%D8%A7%D9%84%D9%8A%D8%A9%20%D8%A8%D8%AF%D8%A7%D8%AE%D9%84%20%D9%85%D8%B1%D8%A8%D8%B9%20%D9%81%D9%8A%20%D8%A7%D9%84%D8%AC%D8%B2%D8%A1%20%D8%A7%D9%84%D8%B3%D9%81%D9%84%D9%8A%20%D9%85%D9%86%20%D8%A7%D9%84%D8%B5%D9%81%D8%AD%D8%A9%D8%8C%20%D8%A8%D8%B9%D8%AF%20%D8%AA%D9%83%D8%A8%D9%8A%D8%B1%D8%AD%D8%AC%D9%85%20%D8%A7%D9%84%D8%AE%D8%B7%20%D9%88%D8%A3%D8%AB%D9%86%D8%A7%D8%A1%20%D8%A7%D8%A8%D8%B1%D8%A7%D8%B2%20%D8%A7%D9%84%D9%86%D8%B5%20%D9%88%D8%A8%D8%B4%D9%83%D9%84%20%D9%85%D8%AA%D8%B2%D8%A7%D9%85%D9%86.")},
ca_es:{hlenlarge:"Visibilitat de text millorat",hlenlargeinfo:decodeURIComponent("Mostra%20la%20frase%20actual%20en%20un%20quadre%20a%20la%20part%20inferior%20de%20la%20p%C3%A0gina%2C%20amb%20una%20mida%20de%20lletra%20m%C3%A9s%20gran%20i%20ressaltat%20de%20text%20simult%C3%A0nia")},cs_cz:{hlenlarge:decodeURIComponent("Zv%C4%9Bt%C5%A1en%C3%AD%20textu"),hlenlargeinfo:decodeURIComponent("Zobrazuje%20pr%C3%A1v%C4%9B%20%C4%8Dtenou%20v%C4%9Btu%20jako%20zv%C4%9Bt%C5%A1en%C3%BD%20text%20v%20samostatn%C3%A9m%20okn%C4%9B%20dole%20na%20str%C3%A1nce.")},
cy_cy:{hlenlarge:"Gwelededd testun gwell",hlenlargeinfo:decodeURIComponent("Dangos%20y%20frawddeg%20sy%E2%80%99n%20cael%20ei%20ddarllen%20yn%20gyfredol%20gyda%20thestun%20bras%20mewn%20blwch%20testun%20ar%20wah%C3%A2n%20wrth%20waelod%20y%20tudalen.")},da_dk:{hlenlarge:decodeURIComponent("Forst%C3%B8rret%20tekstvisning"),hlenlargeinfo:decodeURIComponent("Viser%20den%20aktuelt%20opl%C3%A6ste%20s%C3%A6tning%20med%20forst%C3%B8rret%20skrift%20i%20en%20separat%20tekstboks%20nederst%20p%C3%A5%20siden.")},
de_de:{hlenlarge:"Verbesserte Text-Sichtbarkeit",hlenlargeinfo:decodeURIComponent("Zeigt%20den%20aktuell%20vorgelesenen%20Satz%20in%20einer%20Textbox%20am%20unteren%20Ende%20der%20Seite%20an%2C%20mit%20vergr%C3%B6%C3%9Ferter%20Schrift%20und%20gleichzeitiger%20Texthervorhebung")},es_es:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20actual%20en%20un%20cuadro%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina%2C%20con%20un%20tama%C3%B1o%20de%20letra%20m%C3%A1s%20grande%20y%20resaltado%20de%20texto%20simult%C3%A1nea")},
es_mx:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20que%20se%20est%C3%A1%20leyendo%20actualmente%20con%20el%20texto%20ampliado%20en%20un%20cuadro%20de%20texto%20independiente%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina.")},es_us:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20que%20se%20est%C3%A1%20leyendo%20actualmente%20con%20el%20texto%20ampliado%20en%20un%20cuadro%20de%20texto%20independiente%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina.")},
eu_es:{hlenlarge:"Hobetutako testu ikuspena",hlenlargeinfo:"Erakusten du gaur egun, orrialdeko behealdeko testu independenteko koadro batean handitutako testuaz irakurtzen ari den resalida."},fi_fi:{hlenlarge:decodeURIComponent("Parannettu%20tekstin%20n%C3%A4kyvyys"),hlenlargeinfo:decodeURIComponent("N%C3%A4ytt%C3%A4%C3%A4%20lauseen%20suurennettuna%20ja%20samanaikaisesti%20korostettuna%2C%20sivun%20alaosassa%20olevassa%20ruudussa")},fo_fo:{hlenlarge:decodeURIComponent("St%C3%B8rri%20tekstv%C3%ADsing"),
hlenlargeinfo:decodeURIComponent("V%C3%ADsir%20upplisna%20setningin%20vi%C3%B0%20st%C3%B8rri%20skriftst%C3%B8dd%20%C3%AD%20serligum%20r%C3%BAti%20ni%C3%B0ast%20%C3%A1%20s%C3%AD%C3%B0uni.")},fr_fr:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},fr_be:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),
hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},fr_ca:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},
gl_es:{hlenlarge:"Mellora da visibilidade do texto",hlenlargeinfo:decodeURIComponent("Amosa%20a%20frase%20actual%20nun%20recadro%20na%20parte%20inferior%20da%20p%C3%A1xina%2C%20cunha%20letra%20m%C3%A1is%20grande%20e%20%C3%A1%20vez%20resaltando%20o%20texto.")},hu_hu:{hlenlarge:decodeURIComponent("Megjelen%C3%ADt%C3%A9s%20l%C3%A1that%C3%B3bb%C3%A1%20t%C3%A9tele"),hlenlargeinfo:decodeURIComponent("A%20felolvas%C3%A1ssal%20egy%20id%C5%91ben%20nagyobb%20bet%C5%B1m%C3%A9ret%C5%B1%2C%20kiemelt%20sz%C3%B6veg%20jelenik%20meg%20az%20oldal%20alj%C3%A1n%20egy%20k%C3%BCl%C3%B6n%20ablakban.")},
it_it:{hlenlarge:decodeURIComponent("Visibilit%C3%A0%20testo%20accentuata"),hlenlargeinfo:"Visualizza la frase corrente in un box di grandi dimensioni a fondo pagina utilizzando un font molto grande ed evidenziando il testo in sincrono con la lettura"},ja_jp:{hlenlarge:decodeURIComponent("%E6%96%87%E5%AD%97%E3%81%AE%E6%8B%A1%E5%A4%A7%E8%A1%A8%E7%A4%BA"),hlenlargeinfo:decodeURIComponent("%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B%E6%96%87%E7%AB%A0%E3%82%92%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%8B%E9%83%A8%E3%81%AB%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88%E3%81%97%E3%81%AA%E3%81%8C%E3%82%89%E6%8B%A1%E5%A4%A7%E6%96%87%E5%AD%97%E3%81%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B")},
ko_kr:{hlenlarge:decodeURIComponent("%ED%96%A5%EC%83%81%EB%90%9C%20%EA%B8%80%EC%9E%90%20%ED%91%9C%EC%8B%9C"),hlenlargeinfo:decodeURIComponent("%ED%8E%98%EC%9D%B4%EC%A7%80%20%ED%95%98%EB%8B%A8%EC%9D%98%20%EB%B0%95%EC%8A%A4%20%EC%95%88%EC%97%90%20%EC%9E%88%EB%8A%94%20%ED%98%84%EC%9E%AC%20%EB%AC%B8%EC%9E%A5%EC%9D%84%20%EB%B3%B4%EB%8B%A4%20%ED%81%B0%20%ED%8F%B0%ED%8A%B8%20%EC%82%AC%EC%9D%B4%EC%A6%88%EC%99%80%20%EB%8F%99%EC%8B%9C%20%EA%B8%80%EC%9E%90%20%EA%B0%95%EC%A1%B0%ED%95%98%EA%B8%B0%EB%A1%9C%20%ED%91%9C%EC%8B%9C%ED%95%A9%EB%8B%88%EB%8B%A4.")},
nl_nl:{hlenlarge:"Tekstvergroting",hlenlargeinfo:"Toont de zin die voorgelezen wordt in een apart venster onderaan de pagina, met een grotere lettergrootte en gelijktijdige tekstmarkering."},nl_be:{hlenlarge:"Tekstvergroting",hlenlargeinfo:"Toont de zin die voorgelezen wordt in een apart venster onderaan de pagina, met een grotere lettergrootte en gelijktijdige tekstmarkering."},fy_nl:{hlenlarge:"Ferbettere sichtberheid fan de tekst",hlenlargeinfo:decodeURIComponent("Lit%20de%20sin%20dy%E2%80%99t%20jo%20op%20dit%20stuit%20l%C3%AAze%20%C3%BAtfergrutte%20sjen%20yn%20in%20aparte%20tekst%20%C3%BBnder%20oan%20de%20side.")},
is_is:{hlenlarge:decodeURIComponent("Aukin%20texta%20st%C3%A6kkun"),hlenlargeinfo:decodeURIComponent("S%C3%BDna%20einnig%20ne%C3%B0st%20%C3%A1%20s%C3%AD%C3%B0unni%20setninguna%20sem%20veri%C3%B0%20er%20a%C3%B0%20lesa%2C%20me%C3%B0%20st%C3%A6rra%20letri%20og%20upplitun%20me%C3%B0%20lestrinum.")},no_nb:{hlenlarge:decodeURIComponent("%C3%98kt%20tekstsynlighet"),hlenlargeinfo:decodeURIComponent("Viser%20setningen%20nederst%20p%C3%A5%20siden%2C%20med%20st%C3%B8rre%20skriftst%C3%B8rrelse%20og%20tekstmerking%20mens%20den%20leses%20opp")},
no_nn:{hlenlarge:"Auka tekstsynlegheit",hlenlargeinfo:decodeURIComponent("Setninga%20som%20vert%20lese%20visast%20nederst%20p%C3%A5%20sida%20i%20ein%20eigen%20tekstboks%20med%20forst%C3%B8rra%20skrift.")},pl_pl:{hlenlarge:decodeURIComponent("Widoczno%C5%9B%C4%87%20wyr%C3%B3%C5%BCnionego%20tekstu"),hlenlargeinfo:decodeURIComponent("Wy%C5%9Bwietlaj%20zdanie%2C%20kt%C3%B3re%20jest%20aktualnie%20czytane%20z%20powi%C4%99kszonym%20tekstem%20w%20osobnym%20polu%20na%20dole%20strony.")},pt_pt:{hlenlarge:"Melhorar a visibilidade",
hlenlargeinfo:decodeURIComponent("A%20frase%20%C3%A9%20exibida%20numa%20caixa%2C%20na%20parte%20inferior%20da%20p%C3%A1gina%2C%20com%20um%20tamanho%20maior%20de%20fonte%20e%20o%20texto%20a%20ser%20destacado%20em%20simult%C3%A2neo%20com%20a%20leitura")},pt_br:{hlenlarge:"Melhorar a visibilidade",hlenlargeinfo:decodeURIComponent("A%20frase%20%C3%A9%20exibida%20numa%20caixa%2C%20na%20parte%20inferior%20da%20p%C3%A1gina%2C%20com%20um%20tamanho%20maior%20de%20fonte%20e%20o%20texto%20a%20ser%20destacado%20em%20simult%C3%A2neo%20com%20a%20leitura")},
ru_ru:{hlenlarge:decodeURIComponent("%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B8%D1%82%D1%8C%20%D1%82%D0%B5%D0%BA%D1%81%D1%82"),hlenlargeinfo:decodeURIComponent("%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%BD%D0%BE%D1%81%D0%B8%D0%BC%D0%BE%D0%B5%20%D0%BF%D1%80%D0%B5%D0%B4%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D0%BE%D0%BA%D0%B0%D0%B7%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F%20%D1%83%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%BD%D1%8B%D0%BC%20%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%BC%20%D0%B2%20%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC%20%D0%BE%D0%BA%D0%BD%D0%B5%20%D0%B2%20%D0%BD%D0%B8%D0%B6%D0%BD%D0%B5%D0%B9%20%D1%87%D0%B0%D1%81%D1%82%D0%B8%20%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B.")},
sv_se:{hlenlarge:decodeURIComponent("F%C3%B6rstorad%20text"),hlenlargeinfo:decodeURIComponent("Visar%20meningen%20som%20l%C3%A4ses%20l%C3%A4ngst%20ner%20p%C3%A5%20sidan%2C%20med%20st%C3%B6rre%20typsnitt%20och%20textmarkering.")},sv_fi:{hlenlarge:decodeURIComponent("F%C3%B6rstorad%20text"),hlenlargeinfo:decodeURIComponent("Visar%20meningen%20som%20l%C3%A4ses%20l%C3%A4ngst%20ner%20p%C3%A5%20sidan%2C%20med%20st%C3%B6rre%20typsnitt%20och%20textmarkering.")},tr_tr:{hlenlarge:decodeURIComponent("Geli%C5%9Fmi%C5%9F%20metin%20g%C3%B6r%C3%BCn%C3%BCrl%C3%BC%C4%9F%C3%BC"),
hlenlargeinfo:decodeURIComponent("Ge%C3%A7erli%20c%C3%BCmleyi%20sayfan%C4%B1n%20alt%C4%B1nda%20bir%20kutuda%20daha%20b%C3%BCy%C3%BCk%20yaz%C4%B1%20tipi%20boyutuyla%20ve%20e%C5%9Fzamanl%C4%B1%20metin%20vurgulama%20ile%20g%C3%B6r%C3%BCnt%C3%BCler.")},zh_cn:{hlenlarge:decodeURIComponent("%E5%A2%9E%E5%BC%BA%E6%96%87%E6%9C%AC%E5%8F%AF%E8%A7%81%E6%80%A7"),hlenlargeinfo:decodeURIComponent("%E5%9C%A8%E9%A1%B5%E9%9D%A2%E5%BA%95%E9%83%A8%E6%98%BE%E7%A4%BA%E5%BD%93%E5%89%8D%E5%8F%A5%E5%AD%90%EF%BC%8C%E5%8F%A5%E5%AD%90%E5%AD%97%E4%BD%93%E7%A8%8D%E5%A4%A7%E4%B8%94%E5%90%8C%E6%AD%A5%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%96%87%E6%9C%AC%E3%80%82")},
zh_hk:{hlenlarge:decodeURIComponent("%E6%8F%90%E9%AB%98%E6%96%87%E5%AD%97%E5%8F%AF%E8%A6%96%E5%BA%A6"),hlenlargeinfo:decodeURIComponent("%E8%AB%8B%E5%9C%A8%E9%A0%81%E9%9D%A2%E5%BA%95%E9%83%A8%E6%96%B9%E6%A1%86%E4%B8%AD%E9%A1%AF%E7%A4%BA%E7%95%B6%E5%89%8D%E5%8F%A5%E5%AD%90%EF%BC%8C%E6%96%87%E5%AD%97%E5%B0%87%E4%BB%A5%E5%A4%A7%E8%99%9F%E5%AD%97%E9%AB%94%E4%BB%A5%E5%8F%8A%E5%90%8C%E6%AD%A5%E6%96%87%E5%AD%97%E7%AA%81%E5%87%BA%E9%A1%AF%E7%A4%BA%E3%80%82")}};ReadSpeaker.cfg.extendPhrases(a);rs.st.get("enlarge")||
ReadSpeaker.cfg.item("settings.enlarge","enlargeoff");rs.cfg.defaultsettings&&(rs.cfg.defaultsettings.enlarge="enlargeoff")});
